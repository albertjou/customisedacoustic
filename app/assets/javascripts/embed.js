(function(){if(!window.tlRequire){window.tlRequire={}}var a=window.tlRequire;(function(g){var d={};var f=function(i){return{waitList:[],waitCount:0,callback:null,definition:null,dependencies:null,async:null,id:i}};var e=function(k,j,i){c(k,j,i,true)};var c=function(q,n,j,m){if(d[q]&&d[q].definition){console.log("rice: module is redefined ["+q+"]")}if(!m){m=false}if(!d[q]){d[q]=f(q)}var p=d[q];p.callback=j;p.dependencies=n;p.async=m;for(var l=0;l<n.length;l++){var k=n[l];if(!d[k]){d[k]=f(k)}var o=d[k];if(!o.definition){o.waitList.push(p);p.waitCount++}}if(p.callback&&p.waitCount===0){b(p)}};var h=function(l){if(!l.definition){console.log("rice: error, module does not have a definition ["+l.id+"]")}for(var j=0;j<l.waitList.length;j++){var k=l.waitList[j];k.waitCount--;if(k.callback&&k.waitCount===0){b(k)}}};var b=function(m){var j=[];for(var l=0;l<m.dependencies.length;l++){var k=m.dependencies[l];var n=d[k];j.push(n.definition)}if(m.async){j.push(function(o,i){if(o){m.definition=i;h(m)}else{console.log("rice: error with async initing ["+m.id+"]")}});m.callback.apply(undefined,j)}else{m.definition=m.callback.apply(undefined,j);h(m)}};g.define=c;g.defineAsync=e}(a))}());tlRequire.define("EventDispatcher",[],function(){EventDispatcher=function(){this._listeners={}};EventDispatcher.prototype={constructor:EventDispatcher,addListener:function(a,b){if(!this._listeners[a]){this._listeners[a]=[]}this._listeners[a].push(b)},trigger:function(c,d){var b=this._listeners[c];if(b){copyOfListeners=b.slice(0);var a;for(a=0,len=copyOfListeners.length;a<len;a++){copyOfListeners[a].call(this,d)}}},removeListener:function(c,d){var b=this._listeners[c];if(b){var a;for(a=0,len=b.length;a<len;a++){if(b[a]===d){b.splice(a,1);break}}}}};return EventDispatcher});tlRequire.define("abTest",["hashing"],function(a){var g={};function d(){var k=0;try{k=localStorage.getItem("tlJsUserId");if(!k){k=Math.floor(Math.random()*100);localStorage.setItem("tlJsUserId",k)}}catch(l){}return k}var h=function(k,n,o,m){var l={start:n,end:o,variant:m};if(!g.hasOwnProperty(k)){g[k]=[]}g[k].push(l)};var i=function(k,m){var n=g[k];var l;if(typeof n==="undefined"){return null}for(l=0;l<n.length;l++){var o=n[l];if((o.start<=m)&&(o.end>=m)){return o.variant}}return null};var e=function(k,m){var l=Math.abs(m^a.adler32(k))%100;return i(k,l)};var j=function(k){return e(k,d())};var b=function(m){var k=[];var l;for(l in g){if(g.hasOwnProperty(l)){var n=e(l,m);k.push({testName:l,variant:n})}}return k};var c=function(){return b(d())};var f=function(){g={}};return{addBucket:h,variantForUser:j,activeTestsForUser:c,clear:f,internals:{variantForUserId:e,activeTestsForUserId:b,variantForUserBucketPoint:i}}});tlRequire.define("actionLogger",["jQuery","config","eventCallback","util"],function(j,c,p,f){var g={};var m={};var e={};var b={};var d=f.isTouchDevice;var l=(function(){var s=null;var q=null;function r(u){var v=true;var t=new Date().getTime();if(q){if(t-q<5000){v=false}}if(c.referer){u.referer=c.referer}if(v){if(s){clearTimeout(s);s=null}s=setTimeout(function(){j.getJSON(c.getBaseUrl()+"/action/logActivity?callback=?",u)},200);q=t}}return r}());function o(u,t){var r=t[u];var q=new Date().getTime();var s=(r&&(q-r<5000))?false:true;return s}function a(s,q,v,x){var r=o(s,m);if(!r){return}var w=c.getBaseUrl();var u={thing:s,sceneId:q,e:"click",referer:c.referer};j.getJSON(w+"/action/logThingAccess?callback=?",u,x);var t={event:"tagClick",scene:q,tag:s};p(v,t);m[s]=new Date().getTime()}function k(q,r){if(d&&!b[q]){b[q]=true;return true}return r}function i(t,r,u){var s=o(t,g);if(!s){return}e[t]=new Date();var v=c.getBaseUrl();var q=k(r);setTimeout(function(){j.getJSON(v+"/action/logThingAccess?callback=?",{thing:t,sceneId:r,e:"hover",referer:c.referer,dwell:q});var w={event:"tagHover",scene:r,tag:t};p(u,w)},500);g[t]=new Date().getTime()}var h=function(s){var t=s.data("entertime");if(t){var u=(new Date()).getTime()-t;if(u>250){var r=s.find("img").attr("tl-scene-id");var q=k(r);if(r){setTimeout(function(){j.getJSON(c.getBaseUrl()+"/action/logSceneAccess?callback=?",{time:u,sceneId:r,referer:c.referer,dwell:q})},500)}s.removeData("entertime")}}};var n=function(r,q){var s=e[r];if(s){var t=(new Date()).getTime()-s;if(t>250){if(q){setTimeout(function(){j.getJSON(c.getBaseUrl()+"/action/logThingAccess?callback=?",{time:t,sceneId:q,thing:r,e:"hoverend",referer:c.referer})},500)}e[r]=null}}};return{logActivity:l,logHoverTime:h,logHoverEnd:n,logClick:a,logHover:i}});tlRequire.define("adMatcher",[],function(){function b(){var c=["1.\\d+.\\d+.\\d+","127.0.0.\\d+","localhost","46.45.138.126","ad.doubleclick.net","ad.flatmaids.de","ad.zanox.com","ad.adriver.ru","ad.admitad.com","ad.linksynergy.com","ad-cdn.technoratimedia.com","ad\\d.adfarm1.adition.com","ad1.emediate.dk","ad.retargeter.com","adsfac.eu","adfarm.mediaplex.com","adfile.tattermedia.com","admax.quisma.com","admeta.vo.llnwd.net","adscale.nuggad.net","adserver.wesee.com","ads.foodbuzz.com","ads.giovannicintolo.com","ads.guava-affiliate.com","ads.heias.com","ads.jetpackdigital.com","ads.nelly.com","ads.newtentionassets.net","ads.studentmedia.ucla.edu","ads.thinglink.com","ads.jetpackdigital.com","adtag.neodatagroup.com","adtracker.meinungsstudie.de","aka-cdn-ns.adtech.de","ads\\d.unitymedia.de","analytics.sanoma.fi","analytics.spongecell.com","ariel1.spaceprogram.com","asn.advolution.de","as.aug.me","avatars.scribblelive.com","b.aol.com","b.kavanga.ru","b.thebestlinks.com","b.scorecardresearch.com","bid.openx.net","brandnamic.adclear.net","brightcove.vo.llnwd.net","bs.serving-sys.com","cas.criteo.com","cepep.co","cdn.flashtalking.com","c.statcounter.com","counters.gigya.com","counter.rambler.ru","creatives.klikki.com","cxpfy.com","d.shareaholic.com","delatv.com","d1.openx.org","delivery.ctasnet.com","engine.adzerk.net","fapp.im","fraction8.com","geo.yahoo.com","getpocket.com","googleads.g.doubleclick.net","gravatar.com","hits.e.cl","i-cdn.servedbyopenx.com","imp\\w\\w.tradedoubler.com","imagesrv.adition.com","img-cdn.mediaplex.com","impse.tradedoubler.com","pictela.net","jptracking.elasticbeanstalk.com","\\w+.googleapis.com","khm\\d.google.com","l.betrad.com","\\w+.lijit.com","links.es","leerya.net","maps.nlp.nokia.com","mdsad.com","mt\\d.googleapis.com","malvin.tv","maps.googleapis.com","next.playad.se","notici.me","notifreak.com","networkanalytics.net","otile\\d.mqcdn.com","pagead\\d.googlesyndication.com","paypal.com","peliculasid.biz","pictela.net","pulsemaps.com","readitlaterlist.com","remnant.fmpub.net","reports.wizebar.com","s0.2mdn.net","s\\d+.adform.net","s7.addthis.com","shinystat.com","stats.wordpress.com","tag.admeld.com","t.qservz.com","t.socialgrowthtechnologies.com","tile.openstreetmap.org","\\w+.tile.openstreetmap.org","track.adform.net","track.admaxim.com","tracking.hubspot.com","traffic.shareaholic.com","trk.lqw.me","view.adtraxx.de","videosomg.com","widgets.kiosked.com","www.ftjcfx.com","www.getfreebacklinks.com","www.google.com","www.w3counter.com","www\\d+.a8.net","www.divxatope.com","www.etracker.de","www.callefina.com","www.googleadservices.com"];return new RegExp("//("+c.join("|").replace(".","\\.")+")")}var a=b();return a});tlRequire.define("animUtil",["jQuery"],function(b){function a(e,c,d,f){if(f===undefined){f="easeOutCubic"}if(d===undefined){d=100}if(b.browser.msie&&b.browser.version<9){if(e==="show"){c.show()}else{c.hide()}}else{c.stop(true,true);if(e==="show"){c.fadeIn(d,f)}else{c.fadeOut(d,f)}}}return{variateOpacity:a}});tlRequire.define("browserFeats",["jQuery"],function(a){var b=(function(){var f=null;var g=null;var e=function(h){var i=false;h(function(j){i=true});return i};var c=function(){if(f===null){f=e(function(h){var j=a("html"),i=j[0];j.bind("DOMAttrModified",h);i.setAttribute("___test___",true);i.removeAttribute("___test___");j.unbind("DOMAttrModified")})}return f};var d=function(){if(g===null){g=e(function(h){var i=a("html");i.bind("DOMNodeInserted",h);a("<span />").appendTo(a("body")).remove();i.unbind("DOMNodeInserted")})}return g};return{hasDomAttrModified:c,hasDomNodeInserted:d}}());return b});tlRequire.define("bubbleRenderer",["jQuery","config","util","cssUtil","postMessageManager"],function(h,b,d,i,f){function c(n,o){var k=o.length;var l=0;if(k<50){l=100+k}else{l=100+(k/2.5);if(l>350){l=350}if(k>300){n.addClass("tlLongDescription")}else{if(k>100){n.addClass("tlSemiLongDescription")}}}var m=i.parseCssText(n.attr("style"),false,false);m["min-width"]=l+"px";m["max-width"]="280px";n.css({cssText:d.mapToCssText(m,true)})}function a(k){return k.charAt(0).toUpperCase()+k.slice(1)}function g(l){var k=new RegExp("^[\u0000-\u001F\\s]*[\u0600-\u06FF\u0750-\u077F\uFB50-\uFDFF\uFE70-\uFEFF]");return !!l&&l.match(k)}function j(l,n){var o=new RegExp("([^.]+\\.(?:co\\.)?[a-z]{2,7})$");var m;try{m=o.exec(window.location.hostname)[0]}catch(p){m=window.location.hostname}var k=new RegExp("(^https?://(?:[^/]*)|&url=http[^&]+)"+m).test(l),q=window.top==window.self;if(!k){k=(l.indexOf("://")===-1)}if(k&&q){if(!n){window.location=l}else{n(function(){window.location=l})}}else{if(n){n()}window.open(l)}}function e(t,G,n){var C;var K;var k;var J,u;var E;var q;var r=!d.no(t.thingUrl)?t.thingUrl:"";var x="tl-a-"+t.id;var y=g(t.productName)?"tlRtl":"";if(t.theme==="iframe"){var D=t.iWidth;var p=t.iHeight;k=f.prepareAndGetParameters(t.contentUrl);K=k.srcPmParams;C=k.rtid;var H='<iframe class="tlSpinner tlIframe" name="rmt-'+t.id+'" scrolling="no" src="'+t.contentUrl+K+'" style="width:'+D+"px !important; height:"+p+'px !important;" frameBorder="0"></iframe>';var s;var B;if(!d.no(t.productName)&&t.productName!==null&&t.productName.length>0){B='<p class="tlIframeDescription '+y+'">';if(h.browser.msie&&h.browser.version<8){B+=t.productName.replace(/\n/g,"<br/>")}else{B+=t.productName}B+="</p><hr>"}else{B=""}E=h('<div class="tlThingText" id="'+x+'"><div class="tlThingContent" style="width:'+D+'px!important;"><div class="tlThingClose"/>'+B+'<div class="tlSpinner" style="width:'+D+"px!important;height:"+p+'px!important;"></div></div><div class="tlArrow"></div></div>');u=function(){var L=E.find(".tlThingContent > .tlSpinner");if(!L.is("iframe")){s=h(H);if(L.length==0){E.find(".tlThingContent").css("cssText","width:"+D+"px!important;").append(s)}else{if(L.is("div")){L.replaceWith(s)}}s.load(function(){E.addClass("iframeLoaded");s.unbind("load")});if(h.browser.msie){s.attr("src",s.attr("src"))}}};J=function(L,N,M){j(L,M)}}else{if(t.theme==="rich"){var l=!d.no(t.icon)?t.icon:"";var z=!d.no(t.title)?t.title:"";if(t.productName){z=t.productName;if(h.browser.msie&&h.browser.version<8){z=z.replace(/\n/g,"<br/>")}}else{if(!d.no(t.title)){z=t.title}else{z=""}}z='<span class="tlThingTitle">'+z+"</span>";if(!t.productName&&!d.no(t.subTitle)){z='<span class="tlThingSubTitle">'+t.subTitle+"</span><br />"+z}var m="";var F;if(l){F='<div class="tlVideoIconWrapper"><img class="tlThingIcon" src="'+l+'"/></div>'}else{F='<div class="tlThingIcon"></div>'}var w="";if(!d.no(t.site)){w=t.site;if(!d.no(t.siteUrl)){w='<a href="'+t.siteUrl+'">'+w+"</a>"}w='<div class="tlThingFooter">'+w+"</div>"}E=h('<div class="tlThingText" id="'+x+'"><div class="tlThingContent"><div class="tlThingClose"/>'+m+'<div class="tlNonplayingContent '+y+'"><div class="tlThumbnail">'+F+'<div class="tlThumbnailOverlay"></div></div><span class="tlCenteringOuter"><span class="tlCenteringMiddle"><span class="tlCenteringInner '+y+'">'+z+"</span></span></span></div>"+w+'</div><div class="tlArrow"></div></div>');if(t.contentUrl){k=f.prepareAndGetParameters(t.contentUrl);K=k.srcPmParams;C=k.rtid}J=function(L,R,Q){if(Q){Q()}if(E.hasClass("whitelabel")){return}if(t.contentUrl&&E.find(".tlSpinner").length===0){h(".tlThingClose").not(E.find(".tlThingClose")).mouseup();var M=h(window).width();var S=t.iWidth;var P=t.iHeight;if(S>(M-26)){var O=S/(M-26);S=S/O;P=P/O}var N=h('<iframe class="tlSpinner tlRichIframe" webkitallowfullscreen mozallowfullscreen scrolling="no" src="'+t.contentUrl+K+'" style="width:'+S.toString()+"px !important; height:"+P.toString()+'px !important;" frameBorder="0"></iframe>');E.find(".tlThingContent").append(N);E.addClass("tlPlaying tlSticky");n(R);setTimeout(function(){R.closest(".tlImageContainer").addClass("mouseover")},0)}else{E.find(".tlThingClose").mouseup();if(L.indexOf("http")===0){j(L)}else{window.location=L}}}}else{var o=!d.no(t.title)?t.title:"";var I="";if(o!==""){if(t.productName!==""){I+="<br />"}I+='<a class="tlThingLink" href="'+r+'">'+o+"</a>"}q=(h.browser.msie&&h.browser.version<8)?t.productName.replace(/\n/g,"<br/>"):t.productName;E=h('<div class="tlThingText" id="'+x+'"><p class="tlThingContent '+y+'">'+q+I+'</p><div class="tlArrow"></div></div>');J=function(L,N,M){j(L,M)};c(E,q)}}var A="";if(!d.no(t.theme)){A+=" tlTheme"+a(t.theme)+"Thing"}if(!d.no(t.variant)){A+=" tlVariant"+a(t.variant)+"Thing";if(t.variant=="image"&&G&&r.indexOf(b.getBaseUrl()+"/scene/")!=-1){A+=" whitelabel"}}E.addClass(A);var v={rtid:C,clickHandler:J,hoverHandler:u};E.data("bubbledata",v);return E}return{render:e,setBubbleTagTextStyle:c}});tlRequire.define("callbackManager",[],function(){var a=(function(){var b={};return{runAfter:function(c,d){if(b[c]&&b[c].length==0){d()}else{if(!b[c]){b[c]=[d]}else{b[c].push(d)}}},triggerEvent:function(c){if(b[c]){while(b[c].length>0){(b[c].shift())()}}else{b[c]=[]}}}}());return a});tlRequire.define("config",["namespace","util"],function(c,d){function h(){var l="http://thinglink.local:8080/thinglink";var k="https://thinglink.local:8443/thinglink";if(a.address.charAt(0)=="@"){a.address=l;a.clientId="666666666"}if(a.sslAddress.charAt(0)=="@"){a.sslAddress=k}if(a.embedAddress.charAt(0)=="@"){a.embedAddress=l}if(a.staticAddress.charAt(0)=="@"){a.staticAddress=l}if(a.staticSslAddress.charAt(0)=="@"){a.staticSslAddress=k}if(a.staticAddress.charAt(0)=="/"){a.staticAddress=d.getProtocol()+a.staticAddress}if(a.cssNonce.toString().charAt(0)=="@"){a.cssNonce=Math.round(Math.random()*Math.pow(10,8))}}function f(l,k){var m;for(m in k){if(k.hasOwnProperty(m)){l[m]=k[m]}}return l}var a=f({address:"http://www.thinglink.com",sslAddress:"https://www.thinglink.com",staticAddress:"//cdn.thinglink.me",staticSslAddress:"https://cdn.thinglink.me",embedAddress:"//cdn.thinglink.me",cssNonce:"316221807504",clientId:"310115790974091265",fbAppId:"163019823751039",wlFbAppId:"448074751917449",minWidth:130,minHeight:130,activateImage:function(k){$tlJQ(k).tlImage("scrollTo")},initAfterLoad:true,showPoweredBy:true,eventManager:false,disableContextMenu:false,fourDotsInfo:true,vOverflow:null,hOverflow:null,referer:undefined,nubbinSneakPeek:true,makeNubbinsSticky:false,preventNavigation:false,disableMenuItems:false,forceSecure:false,initialNubbinShowDuration:5000,eventCallback:null,language:null},c.config);h();if(window.location.search.indexOf("thinglinkLocal")!==-1){var j="www.thinglink.com";a.address="http://"+j;a.sslAddress="https://"+j}function e(){return("https:"==document.location.protocol)?a.sslAddress:a.address}function g(){return("https:"==document.location.protocol)?a.staticSslAddress:a.staticAddress}function i(){var m=e();var k=window.location.href;return k.indexOf(m)!=-1}function b(k){if(!a.language&&k){a.language=k}}a.getCDNUrl=g;a.getBaseUrl=e;a.isThinglinkSite=i;a.setRequestLanguage=b;c.config=a;return a});tlRequire.define("cssInjector",["jQuery","config"],function(c,a){function b(i,f,g){var h="";if(g){h=' media="screen"'}if(c("head").has("#"+i).length===0){var e=c('<link id="'+i+'" type="text/css" rel="stylesheet" href="'+f+'"'+h+"></link>").appendTo(c("head"));if(c.browser.msie&&c.browser.version<9){e.attr({href:f,rel:"stylesheet",type:"text/css",id:i})}}}function d(){if(!document.getElementById("tlInjectedCss")){b("tlInjectedCss",a.getCDNUrl()+"/jsec/"+a.cssNonce+"/embed.css");if(c.browser.msie&&c.browser.version<9){b("tlInjectedIeCss",a.getCDNUrl()+"/jsec/"+a.cssNonce+"/embed-ie.css")}}}return{injectEmbedCSS:d,addExternalCss:b}});tlRequire.define("cssUtil",["jQuery","util"],function(d,a){function c(j,l,k){var f={};if(!j){return f}var h=j.split(";");var o;for(o=0;o<h.length&&h[o]!=false;o++){var q,p,n;n=h[o].match(/^ *([^: ]+) *: *(.*)$/);q=n[1];if(l){var g=n[2].match(/^([\d.]+) *(?:px *(?:! *important)? *)?$/i);if(g){p=g[1]}}if((l&&!g)||!l){p=d.trim(n[2]);if(l||k){p=p.replace(/! *important/i,"")}}q=q.toLowerCase();f[q]=p}return f}function b(h,g){var f=c(g.style.cssText,false,true);f.top=h.t+"px";f.left=h.l+"px";f.width=h.w+"px";f.height=h.h+"px";g.style.cssText=a.mapToCssText(f,true)}function e(f){if(d.browser.msie&&d.browser.version<8){d(f).parents().each(function(){var g=d(this);var h=g.css("position");if(g.hasClass("tlImageContainer")){return false}if(h=="relative"||h=="absolute"||h=="fixed"){g.hover(function(){d(this).addClass("on-top")},function(){d(this).removeClass("on-top")})}})}}return{parseCssText:c,repositionElement:b,zIndexWorkaround:e}});tlRequire.define("editor",["jQuery","namespace","sceneUtil","EventDispatcher","config","util","postMessageManager"],function(n,g,h,e,f,i,m){function b(t){if(n("#thinglinkColorbox").length===0){n.thinglinkColorbox.init()}var r=n(window).width();var u=n(window).height();var o=r*0.8;var q=u*0.8;var s=n.thinglinkColorbox({iframe:true,open:false,transition:"none",width:o,height:q,opacity:0.6,overlayClose:false,scrolling:false,onOpen:function(){n("html").css({overflow:"hidden"})},onComplete:function(){var w=n("#thinglinkColorbox").offset().top,v=(n(window).height()-q)/2,x=n(window).scrollTop();if(w>n(window).height()+n(window).scrollTop()){n("#thinglinkColorbox").css({top:x+v})}},onCleanup:function(){n("html").css({overflow:""});a.trigger("editorClose",t)},href:function(){return l(t)}});var p=n("#thinglinkCBLoadedContent iframe");p.load(function(){p.css("background-color","transparent")})}function l(r){var s=h.getSceneUrl(r),u=f.getBaseUrl();var p=r.attr("tl-scene-id");if(!p){p="url="+s;if(!i.no(window.__tlid)){p+="&massId="+window.__tlid}}else{p="sceneId="+p}var t=m.prepareAndGetParameters(u+"/action/embeddedtagedit").srcPmParams;var o;if(f.isThinglinkSite()){o="thinglink_site"}else{o="embedded_image"}var q=Math.floor(Math.random()*10000000);return u+"/action/embeddedtagedit?x="+q+"&embed=true&"+p+"&activityOrigin="+o+t}function k(r,p){var o=l(r);if(p){g.editorPopup=p;p.location.href=o}else{var x=screen.width;var t=screen.height;var v=x*0.8;var s=t*0.8;var q=(x/2)-(v/2);var u=(t/2)-(s/2);g.editorPopup=window.open(o,"editor","status=0,statusbar=0,toolbar=0,location=0,menubar=0,directories=0,resizable=1,height="+s+",width="+v+",left="+q+",top="+u)}}function d(q,p){if(p){try{p.close()}catch(o){}}if(n("#thinglinkColorBoxScript").length===0){n.getScript(f.getCDNUrl()+"/jsec/"+f.cssNonce+"/jquery.colorbox.js",function(){if(q){q()}});g.addExternalCss("tlInjectedColorboxCss",f.getCDNUrl()+"/jsec/"+f.cssNonce+"/colorbox.css",true)}else{if(q){q()}}}function c(p,s,r,q){h.closeAllStickyTags();if(h.isThinglinkSceneView()&&!s){s=function(){window.location.reload()}}g.editorCloseCallback=s;if(!q&&(window.innerWidth<1025||window.innerHeight<585)){k(n(p),r)}else{if(r){try{r.close()}catch(o){}}d(function(){b(n(p))},r)}}var j=function(){};j.prototype=new e();j.prototype.open=c;var a=new j();return a});tlRequire.define("errorReporter",["namespace","config","jQuery"],function(e,d,f){var a=5;var c=0;var b=window.onerror;window.onerror=function(j,h,g){if(h.indexOf("embed.js")===-1){return}if(b){b(j,h,g)}c+=1;if(c>=a){return}var i=d.getBaseUrl();var k={errorMessage:j,file:h,lineNumber:g};f.ajax({url:i+"/api/internal/reportJsError",data:k,dataType:"jsonp"})};return{}});tlRequire.define("eventCallback",["config"],function(a){function b(d,e){var c=d.tlImage("sceneData").permissions;if(a.eventCallback&&typeof(c)!="undefined"&&c.indexOf("plan_premium")>=0){e.image=d[0];e.timestamp=(new Date()).getTime();a.eventCallback(e)}}return b});tlRequire.define("eventDebounce",[],function(){var a=function(f){var e,d=[],g={},b=function(h){if(f.after){f.after.call(h,d,g)}d=[];e=null;g={}};return function c(k){var j=this,i=k.type;var h=(typeof k.originalEvent==="undefined")?k.type:k.originalEvent.type;g.lastOrigEventType=h;if(e){clearTimeout(e)}else{if(f.before){f.before.call(j,i,g)}}if(f.everyTime){f.everyTime.call(j,i,g)}d.push(i);e=setTimeout(function(){b(j)},f.threshold||100);return false}};return a});tlRequire.define("fourDots",["config","postMessageManager","animUtil"],function(a,e,d){function c(f){return a.getBaseUrl()+"/action/embedMoreInfo?id="+f}function b(k,i){k.find(".tlFourDotsInfo").remove();var l=null;var f=null;var j=e.prepareAndGetParameters(a.getBaseUrl()+"/action/embedMoreInfo").srcPmParams;var n=$tlJQ('<iframe width="95%" height="114px" allowtransparency="true" frameBorder="0" src="'+c(i.id)+"&buttonSource=4dots"+j+'"></iframe>');f=$tlJQ("<span></span>");f.append(n);n[0].focus();l=$tlJQ('<div class="tlFourDotsInfo tlDarkFourDots">&nbsp;</div>');var g=l.appendTo(k);g.bind("mouseleave",function(){d.variateOpacity("hide",g,10)});function m(){d.variateOpacity("hide",g,10)}var h=k.find(".tlMenu");h.bind("mouseenter vclick",function(){d.variateOpacity("show",g,10);setTimeout(function(){l.empty().append(f);$tlJQ(".tlImageContainer").off("touchstart").one("touchstart",m)},20)});h.bind("mouseleave",function(o){if($tlJQ(o.toElement).hasClass("thinglinkImage")){m()}})}return{setup:b}});tlRequire.define("hashing",[],function(){function b(c){return Math.abs(a(c.src)).toString(16)}function a(f){var g=65521;var d=1,c=0;var e;for(e=0;e<f.length;++e){d=(d+f.charAt(e).charCodeAt())%g;c=(c+d)%g}return(c<<16)|d}return{adler32:a,generateImageHash:b}});tlRequire.define("imageEventHandlers",["jQuery","callbackManager","config","eventDebounce","jUtil","animUtil","actionLogger"],function(n,f,c,i,g,k,m){var e=false;var d=(function(){return document.documentElement.hasOwnProperty&&document.documentElement.hasOwnProperty("ontouchstart")}());var b=function(p){p.data("entertime",(new Date()).getTime());if(!e){n(window).blur(function(){n(".tlImageContainer").each(function(){m.logHoverTime(n(this))});return true});e=true}};var h="div.nubbin, .tlFirstseen";if(!c.disableMenuItems){h=h+", .tlSidebar"}var o=function(q){if(!q.hasClass("tlHover")){b(q);q.addClass("tlHover");var p=q.find(h);k.variateOpacity("show",p)}},l=function(){return".tlSidebar, .tlFirstseen, .tlFourDotsInfo"+(c.makeNubbinsSticky?"":", div.nubbin, div.nubbin .nubbinGlow")},j=function(p){setTimeout(function(){var q=n("#tlTagContainer div.tlThingText.mouseover");if(!p.hasClass("mouseover")&&q.length==0){p.removeClass("tlHover");m.logHoverTime(p);k.variateOpacity("hide",p.find(l()))}},30)};function a(p){p.removeClass("tlHover");p.find(".tlSidebar"+l()).hide();var q=function(){n("#tlTagContainer div.tlThingText").mouseleave();if(!p.hasClass("mouseover")){p.addClass("mouseover")}o(p)};p.unbind("mouseenter vclick").bind("mouseenter vclick",i({before:q,threshold:50}));p.unbind("mouseleave").bind("mouseleave",function(){p.removeClass("mouseover");j(p)});g.checkImageInViewport(p,function(){p.unbind("mousemove.temp").bind("mousemove.temp",function(){q();p.unbind("mousemove.temp")})})}f.runAfter("initcomplete",function(){if(d){n(document).unbind("touchstart.tlNubbinHide").bind("touchstart.tlNubbinHide",function(q){var p=q.target||q.srcElement;if(n(p).closest(".tlImageContainer").length>0||n(p).closest("#tlTagContainer").length>0){return}var r=new Date().getTime();n(document).unbind("touchend.tlNubbinHide").bind("touchend.tlNubbinHide",function(){n(this).unbind("touchend.tlNubbinHide");var s=new Date().getTime()-r;if(s>200){return}n(".tlImageContainer.tlHover").each(function(){n(this).trigger("mouseleave")})})})}});return{attach:a,showNubbins:o,hideNubbins:j}});tlRequire.define("init",["namespace","util","config","sceneCache","statusManager"],function(c,a,b,e,d){if(window.console===undefined){window.console={log:function(){},warn:function(){},error:function(){}}}(function(){c.init=function(){var j=document.getElementsByTagName("script");var g;var m=j.length;while(m>0){m--;var i=j[m].getAttribute("src");if(i&&(i.search("thinglink.com")!=-1||i.search("thinglink.me")!=-1||i.search("192.168.0.80")!=-1||(b.isThinglinkSite()&&(i.search("embed")!=-1)))){g=j[m];break}}var o;if(g){var n=g.getAttribute("tl-script-loaded");if(a.no(n)||n==="null"||n===null){o=g.src.replace(/^[^\#]+\#?/,"");g.setAttribute("tl-script-loaded",true)}}if(o){if(/^\d+$/.test(o)){var l=document.getElementsByTagName("img");var k=l[l.length-1];k.setAttribute("tl-scene-id",o);e.setCacheSceneId(k.src,o)}else{var p=g.getAttribute("height",2);var h=g.getAttribute("width",2);if(a.no(p)||p==="null"||p===null){p=null}if(a.no(h)||h==="null"||h===null){h=null}f(o,p,h,g)}}if(a.browserIsIE6()){return}};function f(k,g,j,m){var h=a.extractSceneId(k);var l=document.createElement("img");l.src=a.extractUrl(k);if(h.length>0&&h!=="0"){l.setAttribute("tl-scene-id",h)}var i={};if(g!==null){i.height=g}else{i["max-height"]=window.innerHeight+"px"}if(j!==null){i.width=j}else{i["max-width"]="100%"}i.display="block";i["margin-left"]="auto";i["margin-right"]="auto";l.style.cssText=a.mapToCssText(i,true);m.parentNode.insertBefore(l,m)}d.setStatus("loadcomplete")}());if(c.config.initAfterLoad){c.init()}return c.init});tlRequire.defineAsync("jQuery",["init","util","statusManager"],function(e,b,c,a){var d=(function(){var f;function i(k){var o="thinglinkJQueryScript";if(!window.__thinglinkInitStarted){window.__thinglinkInitStarted=true;if(window.$tlJQ){k()}else{var l=document.createElement("script");l.type="text/javascript";l.id=o;var n=function(){window.$tlJQ=jQuery.noConflict(true);k()};if(l.addEventListener){l.addEventListener("load",n,false)}else{l.onreadystatechange=function(){if(this.readyState=="complete"||this.readyState=="loaded"){n()}}}l.setAttribute("src",b.getProtocol()+"//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js");var m=document.getElementsByTagName("head")[0];m.appendChild(l)}}}function j(k){if(f){f()}if(document.readyState==="interactive"){k()}else{if($tlJQ.browser.webkit&&document.readyState==="loaded"){k()}else{$tlJQ(document).ready(k)}}}function h(k){i(function(){j(k)})}function g(k){f=k}return{loadJQuery:h,initCallback:g}}());d.initCallback(function(){c.setStatus("initcomplete")});d.loadJQuery(function(){c.setStatus("jqueryready");a(true,window.$tlJQ)})});tlRequire.define("jQueryPostMessage",["jQuery"],function(b){
/*!
     * jQuery postMessage - v0.5 - 9/11/2009
     * http://benalman.com/projects/jquery-postmessage-plugin/
     *
     * Copyright (c) 2009 "Cowboy" Ben Alman
     * Dual licensed under the MIT and GPL licenses.
     * http://benalman.com/about/license/
     */
var a=function(k){var d,e,l=1,c,h=this,i="postMessage",f="addEventListener",g,j=h[i];k[i]=function(m,o,n){if(!o){return}m=typeof m==="string"?m:k.param(m);n=n||parent;if(j){n[i](m,o.replace(/([^:]+:\/\/[^\/]+).*/,"$1"))}else{if(o){n.location=o.replace(/#.*$/,"")+"#"+(+new Date())+(l++)+"&"+m}}};k.receiveMessage=g=function(o,n,m){if(j){if(o){if(typeof c==="function"&&c()){g()}c=function(p){if((typeof n==="string"&&p.origin!==n)||(k.isFunction(n)&&n(p.origin)===false)){return false}o(p)}}if(h[f]){h[o?f:"removeEventListener"]("message",c,false)}else{h[o?"attachEvent":"detachEvent"]("onmessage",c)}}else{if(d){clearInterval(d)}d=null;if(o){m=typeof n==="number"?n:typeof m==="number"?m:100;d=setInterval(function(){var q=document.location.hash,p=/^#?\d+&/;if(q!==e&&p.test(q)){e=q;o({data:q.replace(p,"")});document.location.hash=""}},m)}}}};a(b);return b.postMessage});tlRequire.define("jQueryTlImage",["jQuery","adMatcher","config"],function(d,a,c){function b(){var g=/^data:/;var f=/^https?:\/\/mt\d+\.google\.com\//;var e={sceneData:function(h){if(!h){return this.data("scene")}else{this.data("scene",h)}},hasSize:function(){if(this.tlImage("isLoaded")){return true}else{var i=(this.height()!==0)&&(this.width()!==0);var h=!(this.height()===24&&this.width()===24);return i&&h}},isLoaded:function(){return(this[0].complete||this[0].readyState===4)},isInspectedByThinglink:function(){return this.hasClass("thinglinkImage")||this.hasClass("thinglinkFiltered")||this.hasClass("thinglinkFetching")},isWhitelabel:function(){var h=this.tlImage("sceneData");return h.indicator&&h.indicator!==""&&h.indicator!=="std"},isOk:function(){var j=this;if(j.hasClass("alwaysThinglink")){return true}if(j.closest(".neverThinglink").length){return false}if(j.css("display")=="none"){return false}var i=j.attr("src");if(a.test(i)||g.test(i)||f.test(i)){return false}var k=["#lightboxImage","#lightbox-image",".cboxPhoto","#fancybox-img",".fancybox-image"];var h=false;d.each(k,function(l,m){if(j.is(m)){h=true;return false}});if(h){return false}if(!j.tlImage("hasSize")){return true}return(j.height()>=c.minHeight&&j.width()>=c.minWidth)},scrollTo:function(){var i=this;var h;if(d.browser.safari){h=d("body")}else{h=d("html,body")}bodyInitTop=h.scrollTop();d(window).load(function(){var j=i.offset().top-40;if(Math.abs(h.scrollTop()-bodyInitTop)<50){h.stop().animate({scrollTop:j},"fast")}})}};d.fn.tlImage=function(h){return e[h].apply(this,Array.prototype.slice.call(arguments,1))}}b();return d.fn.tlImage});tlRequire.define("jQueryVMouse",["jQuery"],function(a){function b(y,H,g){var G="virtualMouseBindings",d="virtualTouchID",c=["vmouseover","vmousedown","vmousemove","vmouseup","vclick","vmouseout","vmousecancel"],x=["clientX","clientY","pageX","pageY","screenX","screenY"],D=y.event.mouseHooks?y.event.mouseHooks.props:[],z=y.event.props.concat(D),B={},I=0,t=0,s=0,q=false,L=[],j=false,S=false,v=(g.addEventListener),u=y(g),F=1,O=0,e;y.vmouse={moveDistanceThreshold:10,clickDistanceThreshold:10,resetTimerDuration:1500};function r(i){while(i&&typeof i.originalEvent!=="undefined"){i=i.originalEvent}return i}function k(U,V){var ad=U.type,ae,ac,W,T,aa,Z,Y,X,ab;U=y.Event(U);U.type=V;ae=U.originalEvent;ac=y.event.props;if(ad.search(/^(mouse|click)/)>-1){ac=z}if(ae){for(Y=ac.length,T;Y;Y){T=ac[--Y];U[T]=ae[T]}}if(ad.search(/mouse(down|up)|click/)>-1&&!U.which){U.which=1}if(ad.search(/^touch/)!==-1){W=r(ae);ad=W.touches;aa=W.changedTouches;Z=(ad&&ad.length)?ad[0]:((aa&&aa.length)?aa[0]:undefined);if(Z){for(X=0,ab=x.length;X<ab;X++){T=x[X];U[T]=Z[T]}}}return U}function Q(V){var T={},i,U;while(V){i=y.data(V,G);for(U in i){if(i.hasOwnProperty(U)){if(i[U]){T[U]=T.hasVirtualBinding=true}}}V=V.parentNode}return T}function C(U,T){var i;while(U){i=y.data(U,G);if(i&&(!T||i[T])){return U}U=U.parentNode}return null}function K(){S=false}function m(){S=true}function R(){O=0;L.length=0;j=false;m()}function p(){K()}function w(){A();I=setTimeout(function(){I=0;R()},y.vmouse.resetTimerDuration)}function A(){if(I){clearTimeout(I);I=0}}function o(U,V,i){var T;if((i&&i[U])||(!i&&C(V.target,U))){T=k(V,U);y(V.target).trigger(T)}return T}function l(T){var U=y.data(T.target,d);if(!j&&(!O||O!==U)){var i=o("v"+T.type,T);if(i){if(i.isDefaultPrevented()){T.preventDefault()}if(i.isPropagationStopped()){T.stopPropagation()}if(i.isImmediatePropagationStopped()){T.stopImmediatePropagation()}}}}function P(U){var W=r(U).touches,V,i;if(W&&W.length===1){V=U.target;i=Q(V);if(i.hasVirtualBinding){O=F++;y.data(V,d,O);A();p();q=false;var T=r(U).touches[0];t=T.pageX;s=T.pageY;o("vmouseover",U,i);o("vmousedown",U,i)}}}function J(i){if(S){return}if(!q){o("vmousecancel",i,Q(i.target))}q=true;w()}function f(W){if(S){return}var U=r(W).touches[0],T=q,V=y.vmouse.moveDistanceThreshold,i=Q(W.target);q=q||(Math.abs(U.pageX-t)>V||Math.abs(U.pageY-s)>V);if(q&&!T){o("vmousecancel",W,i)}o("vmousemove",W,i);w()}function h(V){if(S){return}m();var i=Q(V.target),U;o("vmouseup",V,i);if(!q){var T=o("vclick",V,i);if(T&&T.isDefaultPrevented()){U=r(V).changedTouches[0];L.push({touchID:O,x:U.clientX,y:U.clientY});j=true}}o("vmouseout",V,i);q=false;w()}function E(T){var U=y.data(T,G),i;if(U){for(i in U){if(U.hasOwnProperty(i)){if(U[i]){return true}}}}return false}function N(){}function n(i){var T=i.substr(1);return{setup:function(V,U){if(!E(this)){y.data(this,G,{})}var W=y.data(this,G);W[i]=true;B[i]=(B[i]||0)+1;if(B[i]===1){u.bind(T,l)}y(this).bind(T,N);if(v){B.touchstart=(B.touchstart||0)+1;if(B.touchstart===1){u.bind("touchstart",P).bind("touchend",h).bind("touchmove",f).bind("scroll",J)}}},teardown:function(V,U){--B[i];if(!B[i]){u.unbind(T,l)}if(v){--B.touchstart;if(!B.touchstart){u.unbind("touchstart",P).unbind("touchmove",f).unbind("touchend",h).unbind("scroll",J)}}var W=y(this),X=y.data(this,G);if(X){X[i]=false}W.unbind(T,N);if(!E(this)){W.removeData(G)}}}}var M;for(M=0;M<c.length;M++){y.event.special[c[M]]=n(c[M])}if(v){g.addEventListener("click",function(X){var U=L.length,Y=X.target,aa,Z,ab,W,T,V;if(U){aa=X.clientX;Z=X.clientY;e=y.vmouse.clickDistanceThreshold;ab=Y;while(ab){for(W=0;W<U;W++){T=L[W];V=0;if((ab===Y&&Math.abs(T.x-aa)<e&&Math.abs(T.y-Z)<e)||y.data(ab,d)===T.touchID){X.preventDefault();X.stopPropagation();return}}ab=ab.parentNode}}},true)}}b(a,window,document);return a.vmouse});tlRequire.define("jUtil",["jQuery"],function(c){function a(h,e){var f=c(window);var j=f.scrollLeft(),d=f.scrollTop(),k=h.offset(),g=k.left,i=k.top;if(i+h.height()>=d&&i<=d+f.height()&&g+h.width()>=j&&g<=j+f.width()){e()}}function b(f){var g=c(f);var h,e;var d;if(g.hasClass("tlThingText")){e=g;d=e.attr("id").match(/tl-a-([0-9]+)/)[1];h=c(".tagx.tl-a-"+d+".hovered")}else{h=g;d=g.attr("tl-thing-id");e=c("#tl-a-"+d)}return{nubbin:h,bubble:e}}return{checkImageInViewport:a,getThingPieces:b}});tlRequire.define("main",["namespace","callbackManager","statusManager","jQuery","util","config","cssUtil","tagFetcher","measure","txt","nubbinIconSizeManager","nodeChangeTracker","actionLogger","nubbinRenderer","eventCallback","postMessageManager","sceneUtil","sceneCache","touchManager","hashing","animUtil","fourDots","editor","sharePopup","bubbleRenderer","cssInjector","jUtil","imageEventHandlers","positionThing","tagEventHandlers","eventDebounce","abTest","errorReporter"],function(t,q,m,A,a,G,r,g,e,w,s,d,u,E,x,j,F,z,i,p,k,v,h,l,f,o,y,D,c,C,b,n,B){(function(){var aa=["Edit","Touch","Share"];var N=["Touch","Share"];function O(at,ay){ay=ay||["imgHash","scriptHash","imgAttr"];var ar=null;var ax=null;if(A.inArray("imgAttr",ay)!=-1){ar=at.attr("tl-scene-id");ax=at.attr("tl-passkey")}if(!ar&&A.inArray("scriptHash",ay)!=-1){var aw=at.next().filter("script").attr("src");if(!aw){aw=at.closest(".tlImageContainer").nextUntil().filter("script").first().attr("src")}if(!!aw&&aw.indexOf("thinglink.")!=-1){ar=aw.replace(/^[^\#]+\#?/,"")}}if(!ar&&A.inArray("imgHash",ay)!=-1){var au=at.attr("src");if(!!au){var aq=au?au.match(/^[^\#]+\#tl-([^;]+);(.*)?$/):null;if(!!aq){var av=au.match(/[\?&]tlpasskey=(\w+)/);ar=aq[1];ax=!!av?av[1]:null}}}return{id:ar,passkey:ax}}function H(ay,ax,aw){if(ax){ay.addClass("thinglinkImage");ay.removeClass("thinglinkFiltered");if(ay.parents(".tlImageContainer").length===0){var av="",ar;av+='<div class="tlSidebar">';var aq="";for(ar=0;ar<aa.length;ar++){aq=aa[ar];av+='<span class="tlMenuItem tlMenuItem'+aq+'">';av+='<a class="tlMenu'+aq+'" href="#"></a>';av+='<span class="tlMenuLabel tlMenuLabel'+aq+'">'+w("Sidebar."+aq)+"</span>";av+="</span>"}av+="</div>";var au='<div class="tlImageContainer"><div></div><div class="tlMenuContainer"><span class="tlMenu"></span></div>'+av+"</div>";ay.wrap(au)}}else{ay.addClass("thinglinkFiltered");ay.removeClass("thinglinkImage")}var at=ay.parents(".tlImageContainer");if(aw){at.addClass("tlNoTags")}else{at.removeClass("tlNoTags")}}function al(){var ar=[];var aq=[];A("img").each(function(){var av=A(this);var at=O(av,["imgHash"]);var au=at.id;if(au){av.attr("tl-scene-id",au)}if(av.tlImage("isOk")){if(!av.tlImage("isInspectedByThinglink")){av.addClass("thinglinkFetching");var ax=av.attr("tl-scene-id");var aw=av.attr("tl-passkey")||at.passkey;if((!ax||ax.charAt(0)=="$")&&window.__tlid){ax=F.getSceneUrl(this)}if(ax&&(A.inArray(ax,ar)===-1)){ar.push(ax);if(aw){aq.push(aw)}}}}else{H(av,false)}});if(ar.length>0){g.fetchTags(ar,aq);o.injectEmbedCSS()}}t.rebuild=function(at){if(!at){A("img.thinglinkFiltered").removeClass("thinglinkFiltered");A("img.thinglinkFetching").removeClass("thinglinkFetching");al()}else{var aq=a.extractSceneId(at);if(aq!==""&&aq.charAt(0)!=="$"){var ar=A("img[tl-scene-id="+aq+"]");ar.removeClass("thinglinkFiltered").removeClass("thinglinkFetching")}g.fetchTags(at);o.injectEmbedCSS()}};function ae(ax){if(ax.css("margin-left")=="auto"&&ax.css("margin-right")=="auto"){return true}if(A.browser.msie&&A.browser.version<9){return false}var aw=getComputedStyle(ax[0],null);if(aw.getPropertyValue("margin-left")!="0px"||aw.getPropertyValue("left")!="auto"||aw.getPropertyValue("right")!="auto"||aw.getPropertyValue("float")=="left"||aw.getPropertyValue("float")=="right"){return false}var ar=ax.closest(".tlImageContainer").parent(),aq=getComputedStyle(ar[0]),au=ax[0].getBoundingClientRect(),at=ar[0].getBoundingClientRect();var av=au.left-at.left-parseInt(aq.getPropertyValue("border-left-width"),10)-parseInt(aq.getPropertyValue("padding-left"),10)-parseInt(aw.getPropertyValue("margin-left"),10);return av>0}function ao(ay,ar,au,az){var at=ar[0].style.cssText;ar.data("tlOriginalCss",at);var aw=r.parseCssText(at,false,true),aq={};aq.width=au.w+"px";aq.height=au.h+"px";aq["z-index"]=(az-1);if(ar.css("display")=="block"){aq.display="block";ay.css("display","block");if(ae(ar)){aq["margin-left"]="auto";aq["margin-right"]="auto"}}var ax=ar.css("position");if(ax==="absolute"||ax==="relative"){aq.position=ax;aq.top=ar.css("top");aq.right=ar.css("right");aq.bottom=ar.css("bottom");aq.left=ar.css("left");aw.position="static";if(ax==="absolute"){aq["z-index"]=az}}var aA=ar.css("float");if(aA==="left"||aA==="right"){aq["float"]=aA;delete aw["float"]}ar.css({cssText:a.mapToCssText(aw,true)});ay.css({cssText:a.mapToCssText(aq,true)});var av=e.getCoordinates(ar);ay.find("div.tlMenuContainer").each(function(){A(this).css("cssText","left:"+(5+av.x)+"px !important; top:"+(5+av.y)+"px !important; z-index:"+(az+1))});ay.find("div.tlSidebar").each(function(){A(this).css("cssText","left:"+av.x+"px !important; top:"+(35+av.y)+"px !important; z-index:"+(az+1))});ay.find("div.tlFourDotsInfo").each(function(){A(this).css("cssText","left:"+av.x+"px !important; top:"+av.y+"px !important;width:"+ar.width()+"px !important; z-index:"+(az+1))})}t.reposition=function(at){if(!at){var ar=A(".tlImageContainer .thinglinkImage"),aw;for(aw=0;aw<ar.length;aw++){t.reposition(ar.eq(aw))}}else{var ay=A(at).closest(".tlImageContainer"),ax=A(at).parent(),aE=ay.find(".tagx"),az=ay.css("display"),au;var aC=(ay.css("z-index")+1);ay[0].style.cssText="display: none;";ay.before(at);var aq=at[0].style.cssText;at[0].style.cssText=at.data("tlOriginalCss");var av=e.getDimensions(at);ax.prepend(at);ay.css("display",az);ao(ay,at,av,aC);var aA,aD,aB;for(au=0;au<aE.length;au++){aA=aE.eq(au);aD=aA.data("thing");aB=e.getThingRect(at,aD);r.repositionElement(aB,aA[0]);if(aA.hasClass("hovered")){c(aA)}}s.resizeAllNubbinsIfTooSmall()}};t.removeTags=function(ar){if(!ar){ar=A("body")}var aq=A(ar).find(".tlThingContainer");A.each(aq,function(at,ax){var au=A(ax);var aw=au.find(".tagx");var av=aw.attr("tl-thing-id");A("#tl-a-"+av).remove();au.remove()});j.reset()};t.renderTag=function(av,aq){var ar=f.render(aq,null,c);ar.appendTo("#tlTagContainer");var at=ar.data("bubbledata");var au=E.render(av,aq,at.rtid);return{hoverHandler:at.hoverHandler,clickHandler:at.clickHandler,template:au,bubble:ar}};t.prepareTagForDisplay=function(){C.prepareTagForDisplay.apply(this,arguments)};t.openEditor=function(aq,au,at,ar){h.open(aq,au,at,ar)};t.openShare=function(aq){A(aq).closest(".tlImageContainer").find(".tlMenuShare").click()};t.openTouch=function(aq){A(aq).closest(".tlImageContainer").find(".tlMenuTouch").click()};t.addExternalCss=o.addExternalCss;t.closeAllStickyTags=function(){F.closeAllStickyTags()};function af(ar,at,aq){y.checkImageInViewport(ar,function(){setTimeout(function(){if(at.hasClass("tlSneakPeeked")){return}at.addClass("tlSneakPeeked");var av=at.find(".nubbinGlow");var au=2500;k.variateOpacity("show",av,aq);k.variateOpacity("show",at,100);setTimeout(function(){if(!ar.hasClass("tlHover")&&!G.makeNubbinsSticky){k.variateOpacity("hide",at,au)}k.variateOpacity("hide",av,au/2)},aq)},200)})}function K(aq){setTimeout(function(){var at=aq.find(".nubbin");var ar=function(){af(aq,at,G.initialNubbinShowDuration)};ar();A(window).scroll(ar)},1)}function ah(ar,av,au){i.touch(ar,F.isSceneTouched(au.id));ar.find(".tlPopup").hide();var aq=n.activeTestsForUser();var at=JSON.stringify(aq);u.logActivity({name:"clicked in-image touch",sceneId:ar.find(".thinglinkImage").attr("tl-scene-id"),isThinglinkSite:G.isThinglinkSite(),ABTests:at});return false}function aj(aq,at,ar){l.setup(aq,at,ar)}function T(aq,at,ar){if(typeof(ar.allowEdit)!="undefined"&&ar.allowEdit===false){aq.find(".tlMenuEdit").parents(".tlMenuItem").hide()}else{aq.find(".tlMenuEdit").unbind("click").click(function(au){au.preventDefault();h.open(at)})}}function ac(au){var aw=au[0];var at=au[1];var av=au[2];var az=F.findImageContainer(at).find(".tlMenuLabelTouch");var aq;if(aw){aq="Untouch";az.removeClass("tlTouch").addClass("tlUntouch")}else{aq="Touch";az.removeClass("tlUntouch").addClass("tlTouch")}if(av===undefined){av=0}var ay=az.data("tlTouchCount");if(ay){az.data("tlTouchCount",ay+av)}else{az.data("tlTouchCount",av)}az.text(w("Sidebar."+aq));var ar=az.data("tlTouchCount");if(ar==1){az.prev().attr("title",ar+" touch")}else{az.prev().attr("title",ar+" touches")}var ax;if(ar===1){ax=w("TouchSidebarButton.TouchesOne")}else{if(ar===0){ax=w("TouchSidebarButton.TouchesNo")}else{ax=w("TouchSidebarButton.TouchesOther",ar)}}az.prev().attr("title",ax);return ar}function Q(aq,au,at){if(at.indicator){var ar='background-image: url("'+G.getCDNUrl()+"/api/nubbin/"+at.indicator+'/plain") !important;';A(aq).find(".tlMenu").css("cssText",ar).addClass("tlMenuCustomIndicator")}}function an(aq,aw){aq.find(".tlContextMenu").remove();var av=A('<div class="tlContextMenu"></div>');av.css("z-index",aw+1);av.bind("contextmenu",function(){return false});var au=function(ax){return function(){aq.find(".tlMenu"+ax).click();av.hide();return false}};var at,ar;for(at=0;at<N.length;at++){ar=N[at];A('<div class="tlContextMenuItem tlContextMenu'+ar+'">'+w("ContextMenu."+ar)+"</div>").bind("click",au(ar)).appendTo(av)}aq.append(av);av.attr("unselectable","on").css("-moz-user-select","none").each(function(){this.onselectstart=function(){return false}});A("body").click(function(ax){if(av.css("display")!=="none"){av.hide()}});av.hide()}function I(aq){aq=aq.filter(".tlVariantImageThing");aq.find("img").bind("load",function(){if(aq.is(":visible")){var ar=y.getThingPieces(aq);c(ar.nubbin)}})}function ad(aw,ar,aA,ax,at){var ay=e.getThingRect(ar,aA);var aq=A("#tl-a-"+aA.id);if(aq.length==0){aq=f.render(aA,at,c);I(aq);aq.appendTo("#tlTagContainer")}var av=aq.data("bubbledata");var au=E.render(ay,aA,av.rtid);aw.find(".tl-a-"+aA.id).parent().remove();au.appendTo(aw);var az=au.find(".tl-a-"+aA.id).first();az.data("thing",aA);aq.css("cssText",aq[0].style.cssText+"z-index: "+(ax+1)+";");var aB=az.find(".nubbin").last();aB.css("z-index",ax);r.zIndexWorkaround(aq);C.attach(az,aw)}function S(au,at){var av=au.parents(".tlImageContainer").find(".tlContextMenu");av.show();var ar=at.pageX-au.offset().left;var aq=at.pageY-au.offset().top;av.css("cssText","display: block; left: "+ar+"px !important; top: "+aq+"px !important; z-index: "+av.css("z-index"))}function V(aE){var aM=aE.tlImage("sceneData");if(!aE.tlImage("isOk")){H(aE,false);return}var ax=e.getDimensions(aE);var aJ=e.getExtent(aE,["margin","padding","border"]);if(!aM){if(aE.tlImage("isInspectedByThinglink")){return}aM={things:[],allowEdit:true}}var aF=(aM.things&&aM.things.length!==0);H(aE,true,!aF);try{aE.parents("a").addClass("tlWrappingAnchor");if(!a.no(aM.id)){aE.attr("tl-scene-id",aM.id)}var aP=aE.closest(".tlImageContainer");if(G.nubbinSneakPeek){K(aP)}else{if(G.makeNubbinsSticky){setTimeout(function(){k.variateOpacity("show",aP.find("div.nubbin"),1)},1)}}if(aM.showFourDotsMenu&&G.fourDotsInfo){v.setup(aP,aM,aP.find(".tlMenu"))}var aD=aE.css("z-index")||0;var ay=1;aD=(aD==="auto")?1:parseInt(aD,10)+ay;var au=!aM.titleUrl;if(!au){var aq=a.getDomain(aM.titleUrl);var aL=A('<div class="tlFirstseen"><a href="'+aM.titleUrl+'">'+w("OriginallyThinglinked",aq)+"</a></div>");aP.append(aL);aL.css("cssText","bottom: "+(4+aJ.b)+"px !important; right: "+(6+aJ.r)+"px !important;");aL.click(function(){window.location=A(this).find("a").attr("href")})}ao(aP,aE,ax,aD);T(aP,aE,aM);var aC=(ax.w<130||ax.h<130);var at=function(){aP.find(".tlMenuShare,.tlMenuTouch").hide()};if(aM.id&&!G.disableMenuItems){var av=function(aR){return function(aS){aS.stopPropagation();var aT;if(aR==="Share"){aT=aj}else{if(aR==="Touch"){aT=ah}}aT(aP,aE,aM,aD);return false}};var aH,az;for(aH=0;aH<N.length;aH++){az=N[aH];aP.find(".tlMenu"+az).unbind("vlick").click(av(az))}ac([aM.touched,aM.id,aM.touches]);if(aC||aM.visibility==="PRIVATE"){at()}}else{at()}if(aM.id){Q(aP,aE,aM)}if(!G.disableContextMenu&&!G.disableMenuItems){an(aP,aD)}var aQ=function(aR){return function(aS){var aT=A(this);if(aS.type==="touchend"){aT.click();return false}if(aS.type==="mouseenter"){aT.addClass(aR);aT.next().addClass("tlMenuLabelHover");k.variateOpacity("hide",A(".tlFourDotsInfo"),0)}else{aT.removeClass(aR);aT.next().removeClass("tlMenuLabelHover")}}};var aG,aN;for(aG=0;aG<aa.length;aG++){aN=aa[aG];A(".tlSidebar .tlMenu"+aN).bind("mouseenter mouseleave touchend",aQ("tlMenu"+aN+"Hover"))}if(aM&&a.no(aM.error)){var aI=aE.tlImage("isWhitelabel");D.attach(aP);if(aI){aP.find(".tlMenuItemTouch").hide()}var ar=function(aR){var aT=["contentUrl","icon","thingUrl"],aS,aU;for(aS=0;aS<aT.length;aS++){aU=aT[aS];if(aR[aU]&&aR[aU].substring(0,2)==="//"){aR[aU]=a.getProtocol()+aR[aU]}}};var aA=aM.things,aO,aw;if(aA!==undefined){for(aO=0;aO<aA.length;aO++){aw=aA[aO];ar(aw);ad(aP,aE,aw,aD,aI)}}if(!G.disableContextMenu){var aB=A(aP).find(".tagx");if(aB.length>0){A.each([aB,aE],function(aS,aR){aR.bind("contextmenu",function(aT){if(!G.disableMenuItems){S(aE,aT)}return false})})}}}}catch(aK){console.log(aK)}}function M(aq){if(aq.lang){G.setRequestLanguage(aq.lang)}if(aq.owner===true||aq.owner===false){i.setUserLoggedIn(true)}A("img").each(function(){var av=A(this);var aw=F.getSceneUrl(this);var au=aq[O(av).id];if(!au){au=aq[aw]}if(!au){au=aq[a.cleanURIEncoding(aw)]}if(!au){au=aq[encodeURIComponent(aw)]}if(!au){try{au=aq[decodeURIComponent(aw)]}catch(ay){}}if(!au){au=null}var at=(au&&au.things&&au.things.length!==0);if(aq.owner||(au&&au.allowEdit)||at){q.triggerEvent("tlScenesFound");av.parents(".tlImageContainer").find(".tlMenu").show();av.tlImage("sceneData",au);if(av.tlImage("hasSize")){V(av)}else{av.load(function(){V(av)})}}else{if(au){var ar=av.parents(".tlImageContainer");ar.find(".tlMenu, .tlSidebar").hide(200);ar.unbind("mouseenter mouseleave");var ax=e.getDimensions(av);ar.css({cssText:"width:"+ax.w+"px!important; height:"+ax.h+"px!important;"})}}})}function ak(){var aq=window.location.href.replace(/^[^\#]+\#?/,"");if(aq.match(/tl[\-\=]/)){aq=aq.slice(3);A("img").each(function(){var at=p.generateImageHash(this);if(at==aq){var ar=G.activateImage;if(ar){ar(A(this))}return false}})}}function Z(){A.extend(A.easing,{easeOutCubic:function(ar,at,aq,av,au){return av*((at=at/au-1)*at*at+1)+aq}})}function J(ar){if(ar.tlImage("isOk")){var aq=O(ar).id;if(!aq){if(window.__tlid){t.rebuild(F.getSceneUrl(ar))}else{var at=z.getCacheSceneId(F.getSceneUrl(ar));if(at){ar.attr("tl-scene-id",at);t.rebuild(at)}}}else{t.rebuild(aq)}}}function Y(at){var ar=A(at);var aq=ar.closest(".tlImageContainer");if(aq.length>0){t.removeTags(aq);ar.removeAttr("tl-scene-id");aq.find(".tlEmbedPopup, .tlSharePopup").remove()}J(ar)}var X=function(au,at){if(!au){return}var ar={event:"tagClick",scene:at,tag:au.attr("tl-thing-id")};var aq=A("img[tl-scene-id="+at+"]").first();x(aq,ar)};var ag=function(){A(".tlSharePopup").hide()};var U=function(aq){A(".tlFourDotsInfo iframe").height(aq)};var am=function(at,ar){if(!at){return}if(ar=="true"){ar=true}else{if(ar=="false"){ar=false}else{ar=null}}var aq=at.attr("tl-thing-id");A("#tl-a-"+aq).toggleClass("tlPlaying tlSticky",ar)};var R=function(ar,aq){if(!ar){return}aq=decodeURIComponent(aq);if(/^http:\/\//.test(aq)){ar.attr("href",aq)}else{ar.removeAttr("href")}};var ap=function(ax,aq,az){if(!ax){return}var ay=parseInt(aq,10);var au=parseInt(az,10);if(isNaN(ay)&&isNaN(au)){return}var av=ax.attr("tl-thing-id");var aw=A("#tl-a-"+av).find(".tlThingContent");var at=aw.find("iframe");var ar="";if(ay>0){if(ay<50){ay=50}else{if(ay>800){ay=800}}ar+="width:"+ay+"px !important;";aw.css("cssText","width:"+ay+"px !important")}else{ar+="width:"+at.width()+"px !important;"}if(au>0){if(au<20){au=20}else{if(au>600){au=600}}ar+="height:"+au+"px !important;"}else{ar+="height:"+at.height()+"px !important;"}if(ay>0||au>0){at.css("cssText",ar)}if(ax.hasClass("hovered")){c(ax)}};var L=function(aq){if(t.editorPopup){t.editorPopup.close();t.editorPopup=null}A("#thinglinkCBClose").click();if(t.editorCloseCallback){t.editorCloseCallback.call(this,aq)}};function ab(at){var av=at[0];var aq=at[1];var au=at[2];switch(av){case"resize":ap(aq,au[0],au[1]);break;case"setSticky":am(aq,au[0]);break;case"closeEditor":L(au[0]);break;case"setNubbinClickUrl":R(aq,au[0]);break;case"resizeFourDotsInfo":U(au[0]);break;case"touchLogin":i.touchLoginCallback(null,au[0]);break;case"sharingLinkOpened":ag(au[0],au[1]);break;case"tagClick":var ar=null;X(ar,au[0]);break;default:console.warn("Unknown postmessage command "+av)}}function W(at){if(t.status!="loadcomplete"){var aq=at.parent().parent();t.removeTags(aq);aq.find(".tlMenuShare,.tlMenuTouch").show();var ar=at.attr("tl-scene-id");var au=F.getSceneUrl(at);if(!ar){t.rebuild(au)}else{t.rebuild(ar)}}}function P(){var ar=true;var at=0;var au=A("#tlTagContainer");if(au.length==0){au=A('<div id="tlTagContainer"/>').appendTo("body")}var aq={tagify:function(aE){var aC=A.extend({complete:null,everyLink:false,maxAge:null},aE);var aw=function(){at++;return at};var aA=function(aG,aJ){var aI=A.map(aG,function(aK){return encodeURIComponent(aK)});var aH=aI.join("|");A.getJSON(G.getBaseUrl()+"/api/resolvetag?client_id="+G.clientId+"&url="+aH+(aC.maxAge?"&maxAge="+aC.maxAge:"")+(G.isThinglinkSite()?"":"&callback=?"),aJ)};var aD=function(aG,aK,aL){var aH=aK.content||{};if(A.isEmptyObject(aH)&&aG.attr("href")!=""){aH.title=aG[0].hostname;aH.thingUrl=aG.attr("href")}aH.id=aG.attr("tl-thing-id");aH.productName=aG.attr("title")||"";aG.data("thing",aH);if(!aL){var aJ=f.render(aH,null,c);I(aJ);var aI=aJ.data("bubbledata").rtid;aG.addClass("rtid-"+aI);au.append(aJ)}C.attach(aG)};var az=function(aG){aG.removeAttr("tl-thing-id").removeClass("tagx");aG[0].className=aG[0].className.replace(/tl-a-000\d+ ?/,"")};var av=function(aL,aK){var aI,aH,aM=[];var aJ,aG;for(aI in aK){if(aK.hasOwnProperty(aI)){aJ=aK[aI];for(aH=0;aH<aJ.length;aH++){if(!A.isEmptyObject(aL[aI])||aC.everyTag){aG=aH!=0;aD(aJ[aH],aL[aI],aG);aM.push(aJ[aH])}else{az(aJ[aH])}}}}if(typeof aC.complete=="function"){aC.complete.call(document,aM)}};if(ar){ar=false;o.injectEmbedCSS()}var aF=this.filter("a[href]");var aB={};var ay=[];aF.each(function(){var aG=A(this);var aH=aG.attr("href")!=""?this.href:"#";var aI;if(aC.everyTag||(aH.length>5&&aH.substring(0,1)!="#")){if(aB[aH]){aI=aB[aH][0].attr("tl-thing-id");aB[aH].push(aG)}else{aI="000"+aw();aB[aH]=[aG];ay.push(aH)}aG.addClass("tl-a-"+aI).addClass("tagx").attr("tl-thing-id",aI)}});var ax=function(aG){av(aG,aB)};if(aF.length>0){aA(ay,ax)}},isImageTag:function(){var av=this.attr("tl-thing-id");if(av.substring(0,3)=="000"){return false}return true},reposition:function(){this.each(function(){c(A(this))});return this},setDescription:function(aw,av){this.each(function(){var aA=A(this);var ay=aA.attr("tl-thing-id");var az=A("#tl-a-"+ay);if(az.hasClass("tlThemeIframeThing")){az.find(".tlIframeDescription").text(aw)}else{if(az.hasClass("tlThemeRichThing")){az.find(".tlThingTitle").text(aw)}else{az.find(".tlThingContent").text(aw);f.setBubbleTagTextStyle(az,aw);if(av.length>0){var ax=A('<a href="'+av+'"></a>');ax.text(ax[0].hostname);az.find(".tlThingContent").append(ax)}}}});return this},open:function(av){this.each(function(){var aw=A(this);if(!aw.hasClass("hovered")){var ax=aw.attr("tl-thing-id");A("#tl-a-"+ax).addClass(av?"tlSticky":"");aw.mouseenter();c(aw)}});return this},close:function(){this.each(function(){var av=A(this);var aw=av.attr("tl-thing-id");av.removeClass("tlSticky mouseover linked hovered");if(A("#tl-a-"+aw).hide().hasClass("tlPlaying")){A("#tl-a-"+aw).find(".tlThingClose").click()}});return this},isOpen:function(){return this.hasClass("hovered")}};A.fn.tlTag=function(av){return aq[av].apply(this,Array.prototype.slice.call(arguments,1))}}function ai(){g.finalFetchCompleteCallback(function(){m.setStatus("tagfetchcomplete")});g.dataReceivedCallback(M);j.init();j.addListener("postMessageCommand",ab);i.addListener("updateSceneTouchStatus",ac);h.addListener("editorClose",W);P();var aq=function(at){J(A(at))};var ar=function(at){Y(A(at))};d.track("img","src",aq,ar);A(window).bind("resize",b({after:function(){t.reposition()},threshold:200}));Z();ak();al()}ai()}());return t});tlRequire.define("measure",["jQuery"],function(b){var a={limitSizeHelper:function(e,d,j){var h=18;var g=e[1]-e[0];if(g<h){var c=(h-g)/2;e[0]=e[0]-c;e[1]=e[1]+c;var i=(d-e[0]);if(i>0){e[0]=d;e[1]=e[1]+i}var f=(e[1]-j);if(f>0){e[0]=e[0]-f;e[1]=j}}return e},getThingRect:function(i,f){var e=b(i);if(e.length){var g=a.getExtent(e,["margin","padding","border"]);var h=e.width();var d=e.height();var c=[Math.round(h*f.x1),Math.round(h*f.x2)];var j=[Math.round(d*f.y1),Math.round(d*f.y2)];c=a.limitSizeHelper(c,0,h);j=a.limitSizeHelper(j,0,d);return{t:j[0]+g.t,l:c[0]+g.l,w:(c[1]-c[0]),h:(j[1]-j[0])}}else{return{t:0,l:0,w:0,h:0}}},getCoordinates:function(f){var d=b(f);if(d.length){var e=a.getExtent(d,["margin","padding","border"]);var c=e.l;var g=e.t;return{x:c,y:g}}else{return{x:0,y:0}}},getDimensions:function(g){var d=b(g);if(d.length){var f=a.getExtent(d,["margin","padding","border"]);var c=d.width()+f.l+f.r;var e=d.height()+f.t+f.b;return{w:c,h:e}}else{return{w:0,h:0}}},getExtent:function(f,g){var c=b(f);var e={l:0,t:0,r:0,b:0},d;if(c.length){for(d=0;d<g.length;d++){propName=g[d];widthName=(propName=="border")?"-width":"";e.l+=parseInt(c.css(propName+"-left"+widthName),10)||0;e.t+=parseInt(c.css(propName+"-top"+widthName),10)||0;e.r+=parseInt(c.css(propName+"-right"+widthName),10)||0;e.b+=parseInt(c.css(propName+"-bottom"+widthName),10)||0}}return e}};return a});tlRequire.define("namespace",[],function(){if(window.__thinglink===undefined){window.__thinglink={}}if(window.__tlconfig!==undefined){window.__thinglink.config=window.__tlconfig}return window.__thinglink});tlRequire.define("nodeChangeTracker",["browserFeats"],function(e){function a(f,h,g){return f.each(function(){var k=this;var j=k[h];var i=function(m){if(m&&m.attrName&&m.attrName!=h){return}var n=k[h];if(n!=j){var l=j;j=n;g(k,n,l)}};if(typeof(this.onpropertychange)==="object"){$tlJQ(this).unbind("propertychange").bind("propertychange",i)}else{if(e.hasDomAttrModified()){$tlJQ(this).unbind("DOMAttrModified").bind("DOMAttrModified",i)}}})}function b(f,j,i,h){if(!h){h=1000}var g=function(){$tlJQ(f).each(function(){var m=$tlJQ(this);var l=this[j];var k=m.data("store-value-"+j);if(!k){m.data("store-value-"+j,l)}else{if(l!=k){m.data("store-value-"+j,l);i(this,l,k)}}})};g();setInterval(g,h)}function d(j,g,h,k,i){if(!i){i=1000}var f=function(l){setTimeout(function(){var m=$tlJQ(l);if(m.closest(".tlImageContainer").length!==0&&!m.closest(".tlImageContainer").data("events")){k(l)}else{if(!m.tlImage("isInspectedByThinglink")&&m.tlImage("isOk")){m.addClass("thinglinkFetching");if(m.tlImage("hasSize")){g(l)}else{m.load(function(){g(l)})}}}if(h){h(l)}},1)};if(e.hasDomNodeInserted()){$tlJQ(document).bind("DOMNodeInserted",function(m){var l=$tlJQ(m.target).find(j).each(function(){f(this)});if(m.target.nodeName.toLowerCase()===j){f(m.target)}})}else{setInterval(function(){$tlJQ(j).each(function(){f(this)})},i)}}function c(i,g,f,h){if(e.hasDomAttrModified()||typeof(document.body.onpropertychange)==="object"){a($tlJQ(i),g,h);d(i,f,function(j){a($tlJQ(j),g,h)},h)}else{b(i,g,h);d(i,f,null,h)}}return{track:c}});tlRequire.define("nubbinIconSizeManager",["jQuery","cssUtil"],function(c,b){var a=(function(){var e={};var g=function(l,j,i){if(j=="highlight"){return}var h=0;var k=0;if(e[l]){h=e[l].w;k=e[l].h}if(i.width>h){h=i.width}if(i.height>k){k=i.height}e[l]={w:h,h:k};f(l,h,k)};var f=function(j,i,k){c(".tagx.nubbin-"+j).each(function(){var o=c(this);var n=b.parseCssText(o.attr("style"),true,true);var h=false;if(i>n.width){h=true;var m=parseInt(n.left,10)+n.width/2;n.left=m-i/2;n.width=i}if(k>n.height){h=true;var l=parseInt(n.top,10)+k/2;n.top=l-k/2;n.height=k}if(h){var p={l:n.left,t:n.top,w:n.width,h:n.height};b.repositionElement(p,o[0])}})};var d=function(){var h;for(h in e){if(e.hasOwnProperty(h)){f(h,e[h].w,e[h].h)}}};return{registerIcon:g,resizeAllNubbinsIfTooSmall:d}}());return a});tlRequire.define("nubbinRenderer",["nubbinIconSizeManager","config","util","cssUtil"],function(c,b,a,e){var d=(function(){var i=["plain","hover","hoverlink","highlight"];var h={};function j(k){return b.getCDNUrl()+"/api/nubbin/"+k}function g(n,m){if(n){var l=j(n)+"/"+m;var k=new Image();k.onload=function(){c.registerIcon(n,m,this)};k.src=l;return"style=\"background-image: url('"+l+"') !important;\" "}else{return""}}return function(n){if(!h[n]){var l={};var k;for(k=0;k<i.length;k++){var m=i[k];l[m]=g(n,m)}h[n]=l}return h[n]}}());function f(m,o,k){var h="tl-a-"+o.id;var g=o.nubbin?"nubbin-"+o.nubbin+" ":"";var n=$tlJQ('<div class="tagx '+g+h+'" tl-thing-id="'+o.id+'"></div>');e.repositionElement(m,n[0]);var p=d(o.nubbin);var l=b.getBaseUrl();var j=!a.no(o.thingUrl)?o.thingUrl:"";n.attr("href",j);var i;if(j){i=p.hoverlink}else{i=p.hover}var r=$tlJQ('<div class="nubbin"><div class="nubbinGlow" '+p.highlight+'></div><div class="nubbinIcon" '+p.plain+'></div><div class="nubbinHoverIcon" '+i+"></div></div>");r.appendTo(n);var q;if(k){q=$tlJQ('<div id="'+k+'" class="tlThingContainer"></div>')}else{q=$tlJQ('<div class="tlThingContainer" ></div>')}n.appendTo(q);return q}return{render:f}});tlRequire.define("popup",["config","txt"],function(b,a){function c(e,g,m,f){var d=$tlJQ(m,e).first();if(d.length===0){var j=$tlJQ.trim(m.replace(/\./g," "));d=$tlJQ('<div class="'+j+' tlPopup"></div>');var l=$tlJQ('<a href="#" class="tlCloseBtn"></a>');var k=$tlJQ('<div class="tlPopupInner"></div>');l.bind("vmouseup",function(n){d.hide();return false});if(f){f(k)}if(b.showPoweredBy&&!g.tlImage("isWhitelabel")){var i=b.address+"/?buttonSource="+m;var h=$tlJQ('<a href="'+i+'" class="thinglinkInfo">'+a("poweredBy")+"</a>");h.click(function(n){window.open(i)});k.append(h)}d.append(k);d.append(l);e.append(d);d.click(function(n){var o=$tlJQ(n.target);if(o.hasClass("shareIframeHelpIcon")&&o.attr("href").length>0){o.click()}n.stopPropagation();return false});$tlJQ("body").click(function(n){if(d.css("display")!=="none"){d.fadeOut(250)}})}e.find(".tlPopup").hide();d.show();return false}return{setup:c}});tlRequire.define("positionThing",["jQuery","config","util","cssUtil","measure"],function(f,b,a,e,d){function c(t){var k=t.attr("tl-thing-id");var O=f("#tl-a-"+k);var E=O.find(".tlArrow");var x=13;var y=O.height();var h=Math.round(((t.height()/2)-y-x));var H=t.closest(".tlImageContainer");var G;if(b.hOverflow!==null){G=b.hOverflow}else{G=true}var B;if(b.vOverflow!==null){B=b.vOverflow}else{B=true}var P;var L;var m=t.offset(),I=f(document.body);if(f.inArray(I.css("position"),["absolute","relative"])!==-1){var F=a.getOffsetRect(document.body);m.left=m.left-F.left;m.top=m.top-F.top}var U=O.hasClass("tlPlaying")?15:5;var T=5;if(B===false){var l=parseInt(t.css("top").replace("px",""),10);P=l+h-U;var K=H.height();var g=K-l-t.height();L=g+h-T}else{P=m.top+h-U;var p=f(window).height();var A=p-m.top-t.height();L=A+h-T}var w=O.find(".tlUpArrow");var D=O.find(".tlCenterArrow");if(P<0){E.css("cssText","display:none;");if(L>0){h=Math.round((t.height()/2)+13);E=w;if(E.length===0){E=f('<div class="tlUpArrow"></div>');f(".tlThingContent",O).before(E)}}else{w.css("cssText","display:none");h=h-P;E=D;if(E.length===0){E=f('<div class="tlCenterArrow"></div>');f(".tlThingContent",O).before(E)}}}else{w.css("cssText","display: none;")}E.css("cssText","");var S=O[0]?e.parseCssText(O[0].style.cssText,true):{};var z="min-width: "+S["min-width"]+"px !important; z-index: "+O.css("z-index")+"; display: block;";if(S["max-width"]){z=z+"max-width: "+S["max-width"]+"px !important;"}var N=d.getDimensions(O).w;var i=f.browser.msie?"width: "+N.toString()+"px !important;":"";var C=t.width();var j=Math.round((C-N)/2);var M=parseInt(t.css("left").replace("px",""),10);var v=H.width();var r=5;var q=O.hasClass("tlPlaying")?15:5;var s=M+j-r;var R=v-q-(M+j+N);var u=0;var o;if(G===false&&s<0&&R>0){u=-s}else{if(G===false&&R<0&&s>0){u=R}else{if(f.browser.msie){E.css("cssText",i)}}}O.css("cssText","display:none !important;");var n=function(){var Y=m.left+j+u;var W=Y-r;var V=a.getWindowSize().width;var X=V-(Y+N)-q;return{l:W,r:X}};var Q=n();if((Q.l+Q.r)<0){r-=5;q-=5;Q=n()}if(Q.l<0&&Q.r>0){u=u-Q.l}else{if(Q.r<0&&O.hasClass("tlPlaying")){var J=0;if(Q.l<Q.r){J=Q.r-Q.l;if(J>5){J=5}}Q.r-=J;u=u+Q.r}else{if(Q.r<0&&Q.l>0){u=u+Q.r}}}if(u!=0){j=j+u;o=Math.round((N-17)/2-u);E.css("cssText",i+"background-position: "+o+"px top !important;")}O.css("cssText",z+"top: "+(m.top+h).toString()+"px !important; left: "+(m.left+j).toString()+"px !important;")}return c});tlRequire.define("postMessageManager",["namespace","jQueryPostMessage","EventDispatcher","config"],function(c,n,a,b){var p=c.postMessageManager;if(typeof p==="undefined"||typeof p.addListener==="undefined"){var e={};var o={};var j=function(){e={};o={}};var l=function(r){var q=k(r);o[q]=true;var s;var t=false;while(!t){s=(" "+Math.random()).substr(3);if($tlJQ("#"+s).length==0){t=true}}e[s]=q;return s};var k=function(r){var q=r.indexOf("/",8);if(q>0){return r.substring(0,q)}return r};var i=function(q){if(o[q]){return true}return false};var d=function(u){var q=u.data;var x=q.split("/");var v=x[0];var r=x[1];var s=x.slice(2);var w=u.origin;if(w){var t=e[v];if(w!==t){return}}var y=[r,f(v),s];p.trigger("postMessageCommand",y)};var f=function(r){var q=$tlJQ("#"+r);var s;if(q.length==0){s=$tlJQ(".rtid-"+r)}else{s=q.find(".tagx")}if(s.length==0){return}return s};var h=function(){$tlJQ.receiveMessage(d,i)};var g=function(r){var v=window.location.href.split("#")[0];var s="";var u="";var q="";try{s=l(r);u=encodeURIComponent(v);q="#rtid="+s+"&target="+u;if(b.preventNavigation){q+="&preventNavigation=true"}if(r.indexOf("#")>0){q="&"+q.substring(1)}}catch(t){}return{rtid:s,target:u,srcPmParams:q}};var m=function(){};m.prototype=new a();m.prototype.init=h;m.prototype.reset=j;m.prototype.prepareAndGetParameters=g;p=new m();c.postMessageManager=p}return p});tlRequire.define("sceneCache",[],function(){var b={};function a(e,d){b[e]=d}function c(d){return b[d]}return{getCacheSceneId:c,setCacheSceneId:a}});tlRequire.define("sceneUtil",["jQuery","util"],function(h,d){function a(j){return h("img[tl-scene-id="+j+"]").closest(".tlImageContainer")}function c(j){return j.find("img").attr("tl-scene-id")}function g(j){return a(j).find(".tlMenuLabelTouch").hasClass("tlUntouch")}function f(j){return a(j).find(".tlMenuLabelTouch").data("tlTouchCount")}function i(l,j){var k=h(l);var m=k[0].src.replace(/#.*$/,"");if(j){m=m+";"+j}return m}function b(){return h("body").hasClass("permaScene")}function e(){h(".tlThingClose").mouseup()}return{findImageContainer:a,getContainerSceneId:c,isSceneTouched:g,getSceneTouchCount:f,isThinglinkSceneView:b,getSceneUrl:i,closeAllStickyTags:e}});tlRequire.define("sharePopup",["util","config","postMessageManager","popup","hashing","sceneUtil","measure"],function(g,d,j,b,c,f,a){function h(k){return d.sslAddress+"/scene/"+k}function i(n){var r=n.tlImage("sceneData");var s=n.closest(".tlImageContainer");if(!n){return}var m=n.attr("tl-scene-id");var p=c.generateImageHash(n[0]);var k=encodeURIComponent(h(m));var o;var t=$tlJQ('head meta[name="identifier-URL"]').attr("content");if(!!t){o=t}if(d.isThinglinkSite()&&!o){o=k}else{if(!o){o=window.location.href}var q=o.indexOf("#");if(q===-1){o=encodeURIComponent(o)+"%23tl-"+p}else{if(q==o.length-1||o.substring(q,q+4)==="#tl-"){o=encodeURIComponent(o.substring(0,q))+"%23tl-"+p}else{o=encodeURIComponent(o)}}}return o}function e(t,q,s){f.closeAllStickyTags();var o=$tlJQ("#tlOverlayContainer");if(o.length==0){o=$tlJQ('<div id="tlOverlayContainer"/>').appendTo("body")}var n=".tlShareIframePopup.tl-scene-"+q.attr("tl-scene-id");var m=$tlJQ(n,o);if(m.length>0){m.show()}else{b.setup(o,q,".tlShareIframePopup.tlSharePopup.tl-scene-"+q.attr("tl-scene-id"),function(A){var B=d.getBaseUrl()+"/embedshare/"+s.id;var z=j.prepareAndGetParameters(B).srcPmParams;var x=g.getDomain(window.location.href);var y=x?c.adler32(x):"";var E=$tlJQ(document).innerHeight();var D=A.height;var w=Math.min(E-50,380);var C=$tlJQ('<iframe id="tlSharingFrame" src="'+B+"?shareUrl="+i(q)+"&domainHash="+y+z+'" type="text/html" height="'+w+'px" + frameBorder="0"></iframe>');A.append(C)})}if(m.length==0){m=$tlJQ(n,o)}var k=a.getDimensions(q).w;var r=q.offset();var v=a.getDimensions(m).w;var p=parseInt(r.left+(k/2)-(v/2),10);var l=$tlJQ(window).width();if(p<0){p=0}else{if(p-v>l){p=l-v}}var u=r.top<13?13:r.top;m.css("cssText",m[0].style.cssText+"left: "+p+"px !important; top: "+u+"px !important;")}return{setup:e}});tlRequire.define("statusManager",["namespace","config","callbackManager"],function(d,c,b){function a(e){d.status=e;if(c.eventManager&&c.eventManager.trigger){c.eventManager.trigger("statusChanged",e)}b.triggerEvent(e)}return{setStatus:a}});tlRequire.define("tagEventHandlers",["jQuery","callbackManager","eventDebounce","positionThing","actionLogger","imageEventHandlers","config","jUtil","util"],function(m,i,d,c,j,o,s,l,a){var r=a.tLog;var g=a.isTouchDevice;var q=function(v,u,x){var w=v.find(".thinglinkImage").first();var t=w.attr("tl-scene-id");j.logClick(u,t,w,x)},b=function(v,u){var w=v.find(".thinglinkImage").first();var t=w.attr("tl-scene-id");j.logHover(u,t,w)},n=function(v,u){var w=v.find(".thinglinkImage").first();var t=w.attr("tl-scene-id");j.logHoverEnd(u,t,w)};var e=function(y,x,z,v){var u;if(y.nubbin.tlTag("isImageTag")){u=function(A){q(v,z.id,A)}}var w=s.preventNavigation&&!(z.theme=="rich"&&z.contentUrl&&y.bubble.find(".tlSpinner").length===0);if(!w&&z.theme=="iframe"){w=!y.bubble.hasClass("iframeLoaded")}var t=y.nubbin.attr("href");if(!w){w=!t}if(!w){x.clickHandler.call(this,t,y.nubbin,u);return true}if(u){u()}return false},h=function(t){t=t||l.getThingPieces(this);if(!t.bubble.hasClass("tlPlaying")){setTimeout(function(){if(!t.bubble.hasClass("mouseover")&&!t.nubbin.hasClass("mouseover")){if(t.nubbin.hasClass("hovered")){var u=t.nubbin.attr("tl-thing-id");var v=t.nubbin.parents(".tlImageContainer");n(v,u)}t.nubbin.removeClass("linked hovered");t.bubble.hide()}},50)}},p=function(v,t,w){var u=t;if(v&&v.clientX){u=document.elementFromPoint(v.clientX,v.clientY)}if(u==w.nubbin.find(".nubbinHoverIcon")[0]){if(!w.nubbin.hasClass("mouseover")){w.nubbin.addClass("mouseover")}if(!t.hasClass("mouseover")){t.addClass("mouseover")}}else{if(u==t.find(".thinglinkImage")[0]){if(!t.hasClass("mouseover")){t.addClass("mouseover")}h(w)}else{h(w);o.hideNubbins(t)}}};i.runAfter("initcomplete",function(){if(g){m(document).unbind("touchstart.tlBubbleHide").bind("touchstart.tlBubbleHide",function(u){var t=u.target||u.srcElement;if(m(t).closest(".tlImageContainer").length>0||m(t).closest("#tlTagContainer").length>0){return}var v=new Date().getTime();m(document).unbind("touchend.tlBubbleHide").bind("touchend.tlBubbleHide",function(){m(this).unbind("touchend.tlBubbleHide");var w=new Date().getTime()-v;if(w>200){return}m(".tlImageContainer .tagx.hovered").each(function(){var x=l.getThingPieces(this);if(x.bubble.hasClass("mouseover")){x.bubble.trigger("mouseleave")}if(x.nubbin.hasClass("mouseover")){x.nubbin.trigger("mouseleave")}if(x.bubble.hasClass("tlSticky")){x.bubble.find(".tlThingClose").mouseup()}})})})}});function k(t,v){v=v||l.getThingPieces(this);var u=v.bubble.data("bubbledata");if(u&&u.hoverHandler){t=u.hoverHandler}if(t){t()}c(v.nubbin);v.bubble.show();if(v.nubbin.attr("href")){v.nubbin.addClass("linked")}v.nubbin.addClass("hovered")}function f(E,w){var A=l.getThingPieces(E),z=A.bubble.data("bubbledata"),D=A.nubbin.data("thing"),v=false;w=w||A.nubbin.closest(".tlImageContainer");var x=function(G,F){F=F||A;F.nubbin.removeClass("mouseover");p(G,w,F)};var y={};var B=function(G,H){y.hideBubblesForAllExcept(A.nubbin);if(!G){var F=null;if(z&&z.hoverHandler){F=z.hoverHandler}k(F,A);if(H){b(w,D.id)}}A.nubbin.addClass("mouseover");if(!w.hasClass("mouseover")){w.addClass("mouseover")}};var u=function(F){w.find(".tagx").not(F).each(function(){var G=l.getThingPieces(this);x(null,G)})};y={mouseOverNubbin:B,attemptTagClick:e,hideBubblesForAllExcept:u};var C=false;var t=false;A.nubbin.unbind("vmouseout vmousecancel").bind("vmouseout vmousecancel",d({after:function(F,G){C=false},threshold:50}));if(A.nubbin.tlTag("isImageTag")){A.nubbin.unbind("mouseenter vclick").bind("mouseenter vclick",d({before:function(F,G){G.nubbinsVisible=w.hasClass("tlHover");G.bubbleVisible=A.nubbin.hasClass("hovered");C=C||!G.nubbinsVisible;if(!G.nubbinsVisible){G.nubbinsVisible=(A.nubbin.find(".nubbinGlow").css("display")!="none");o.showNubbins(w)}if(G.nubbinsVisible){y.mouseOverNubbin(G.bubbleVisible,true)}v=true},everyTime:function(F,H){if(F==="mouseenter"){if(g&&(!H.bubbleVisible)&&(!H.vclickInThisSequence)){t=true}}if((F==="vclick")&&(H.vclickInThisSequence)){return}if(F==="vclick"){H.vclickInThisSequence=true}if(!C&&H.nubbinsVisible&&H.bubbleVisible&&!t&&(F==="vclick")){H.vclickInThisSequence=true;var G=y.attemptTagClick(A,z,D,w);if(G){A.nubbin.trigger("mouseleave")}}else{if(F=="mouseenter"){v=true}}if(H.lastOrigEventType==="touchend"){t=false}},after:function(H,I){var G=(typeof v=="function");if(!I.nubbinsVisible&&!g&&!G){y.mouseOverNubbin(I.bubbleVisible,true)}else{if(G){v()}}var F=A.nubbin.hasClass("hovered");if(F&&(!t)){m(document).one("touchend",function(J){if(m("#tlTagContainer").has(J.target).length===0){x(J)}})}v=false},threshold:70}))}else{A.nubbin.unbind("mouseenter vclick").bind("mouseenter vclick",d({before:function(F,G){G.nubbinsVisible=w.hasClass("tlHover");G.bubbleVisible=A.nubbin.hasClass("hovered");C=C||!G.nubbinsVisible;y.mouseOverNubbin(G.bubbleVisible,false)},everyTime:function(F,G){if(G.bubbleVisible&&F=="vclick"){y.attemptTagClick(A,z,D,w)}},threshold:50}))}A.nubbin.unbind("mouseleave").bind("mouseleave",function(F){if(v){v=x}else{x(F)}});A.bubble.unbind("mouseenter").bind("mouseenter",function(F){A.bubble.addClass("mouseover")});A.bubble.unbind("mouseleave").bind("mouseleave",function(F){A.bubble.removeClass("mouseover");p(F,w,A)});A.bubble.unbind("vmouseup").bind("vmouseup",d({before:function(F,G){G.tagBubbleClickHandled=false},everyTime:function(F,G){if(!G.tagBubbleClickHandled){y.attemptTagClick(A,z,D,w);G.tagBubbleClickHandled=true}},after:function(F,G){A.bubble.trigger("mouseenter");x(null)},threshold:20}));A.bubble.unbind("vclick").bind("vclick",function(F){return false});if(D.theme=="rich"){A.bubble.find("tlThingFooter").delegate("a","vclick",function(F){window.open(this.href);return false})}A.bubble.find(".tlThingClose").bind("vmouseup",function(H){H.preventDefault();H.stopPropagation();A.bubble.removeClass("tlPlaying iframeLoaded");var F=A.bubble.find(".tlRichIframe");F.hide().remove();var G=A.bubble.find(".tlIframe");if(G.length>0){G.hide().remove();A.bubble.find(".tlSpinner").show()}A.bubble.removeClass("mouseover").hide();x(H,A);if(g&&!w.hasClass("mouseover")){w.addClass("mouseover")}return false});return{_i:y}}return{attach:f,prepareTagForDisplay:k}});tlRequire.define("tagFetcher",["jQuery","util","config"],function(d,b,c){var a=function(){var n;var i;function l(u,p){var t=[];var s="",q;for(q=0;q<u.length;q++){var v=b.cleanURIEncoding(u[q]);if((s.length+v.length+2)<p){if(s.length>0){s+="|"}s+=v}else{t.push(s);s=""}}if(s.length>0){t.push(s)}return t}var g=[];var m;var o=[];function e(q,p){g=g.concat(q);if(p){o=o.concat(p)}if(m){clearTimeout(m);m=null}m=setTimeout(function(){j(g,c.forceSecure,c.referer);g=[];m=null},80)}function j(D,v,t){var C=c.getBaseUrl();var s=l(D,1650);var u=s.length;var B=function(E){if(n){n(E)}u=u-1;if(u===0&&i){i()}};var x;var r=d(window);var A=r.width();var y=r.height();var q=l(o,2000);for(x=0;x<s.length;x++){var z=s[x];var w={url:z,p:x,passkeys:q[0]};if(A<700){w.vw=A}if(y<700){w.vh=y}var p=d('meta[name="thinglinkFilter"]').attr("content");if(p){w.filter=p}if(window.__tlid!==undefined){w.massId=window.__tlid}if(v){w.forceSecure=true}if(t){w.referer=c.referer}d.ajax({url:C+"/api/tags",data:w,dataType:"jsonp",success:B})}}function k(r,q){var p=b.extractSceneId(r);if(p!==""&&p.charAt(0)!=="$"){r=p}if((r.length===undefined)||typeof(r)==="string"){r=[r]}else{if(r.length>1){r=r.sort()}}e(r,q)}function f(p){i=p}function h(p){n=p}return{fetchTags:k,dataReceivedCallback:h,finalFetchCompleteCallback:f}};return a()});tlRequire.define("touchManager",["config","txt","sceneUtil","postMessageManager","abTest"],function(u,j,q,c,e){var l;var i;var d;var f;var h="original";function a(w){var v={title:"",content:""};if(h==="DoYouLikeThisImage"){v.title=j("TouchDialogPreSignup.TitleDoYouLikeThisImage");v.content=j("TouchDialogPreSignup.ContentDoYouLikeThisImage",'<a href="#">',"</a>")}else{if(w===1){v.title=j("TouchDialogPreSignup.TouchesOne")}else{if(w===0){v.title=j("TouchDialogPreSignup.TouchesNo")}else{v.title=j("TouchDialogPreSignup.TouchesOther",w)}}v.content=j("TouchDialogPreSignup.ContentOriginal",'<a href="#">',"</a>")}return v}function t(w,x){if(!w){w=q.findImageContainer(v)}var v=q.getContainerSceneId(w);if(f){b(w,v,x)}else{g(w,v)}}function s(y,w,v){if(i){clearTimeout(i);i=null}if(v&&v>100){return}var x;if(!v){x=3000;v=0}else{if(v<60){x=1000}else{x=3000}$tlJQ.ajax({url:u.getBaseUrl()+"/api/me",cache:false,dataType:"jsonp",success:function(z){if(z.name){clearTimeout(i);i=null;if(d){d.close();d=null}o(y,w)}else{if(!d||(d&&d.closed===true)){clearTimeout(i);i=null}}}})}i=setTimeout(function(){s(y,w,v+1)},x)}function g(x,w){var A="tlTouchPreSignupPopup";var B=q.getSceneTouchCount(w);var C=a(B);var v=x.find("."+A).first();if(v.length===0){v=$tlJQ('<div class="'+A+' tlTouchPopup tlPopup"></div>');var E=$tlJQ('<div class="tlPopupInner"><h3></h3><p class="tlTouchPopupContent" style="text-align:center !important;"></p></div>');var z=$tlJQ('<a href="#" class="tlCloseBtn"></a>');z.bind("vmouseup",function(F){v.hide();return false});v.append(E);v.append(z);var y=v.find("p.tlTouchPopupContent");y.append(C.content);y.find("a").click(function(){p(x,w)});x.append(v)}x.find(".tlPopup").hide();var D=v.find("h3");D.html(C.title);setTimeout(function(){v.show()},10)}function p(x,v){var B=u.sslAddress+"/action/touchLogin";var y=c.prepareAndGetParameters(B);var z=y.rtid;var A=y.target;var w=u.sslAddress+"/auth/connect?response_type=code&client_id="+u.clientId+"&state="+z+"/touchLogin/"+v+";"+A+"&redirect_uri="+encodeURIComponent(B);d=window.open(w,null,"width=950,height=588,scrollbars=yes");s(x,v)}function b(w,v,x){var y;if(x){y="untouch"}else{y="touch"}$tlJQ.ajax({url:u.sslAddress+"/api/scene/"+v+"/touch?method="+y,cache:false,dataType:"jsonp",success:function(B){var z;if(!B.error){var A;if(!B.results.touched&&y==="untouch"){A=-1}else{if(B.results.touched&&y==="touch"){A=1}}k.trigger("updateSceneTouchStatus",[B.results.touched,v,A]);z=q.getSceneTouchCount(v)}n(w,B,v,z)}})}function n(y,x,w,B){var A="tlTouchStatusPopup";if(B<0){B=0}var v=y.find("."+A).first();if(v.length===0){v=$tlJQ('<div class="'+A+' tlTouchPopup tlPopup"></div>');var D=$tlJQ('<div class="tlPopupInner"><h3></h3><p></p><</div>');v.append(D);y.append(v)}y.find(".tlPopup").hide();var C=v.find("h3");var z=v.find("p");if(x.error){C.text(j("TouchDialog.TitleError"))}else{if(x.results.touched){C.text(j("TouchDialog.TitleTouch"))}else{C.text(j("TouchDialog.TitleUntouch"))}if(B===1){z.text(j("TouchDialog.TouchesOne"))}else{if(B===0){z.text(j("TouchDialog.TouchesNo"))}else{z.text(j("TouchDialog.TouchesOther",B))}}}v.stop(true,true).show();if(l){clearTimeout(l);l=null}l=setTimeout(function(){v.hide(500);l=null},1300)}function o(w,v){f=true;t(w,q.isSceneTouched(v))}function m(v){f=v}e.addBucket("touchLoginTxt",0,49,"original");e.addBucket("touchLoginTxt",50,99,"DoYouLikeThisImage");h=e.variantForUser("touchLoginTxt");var r=function(){};r.prototype=new EventDispatcher();r.prototype.touch=t;r.prototype.touchLoginCallback=o;r.prototype.setUserLoggedIn=m;var k=new r();return k});tlRequire.define("txt",["jQuery","config"],function(d,c){var a={poweredBy:{en:"Powered by ThingLink",fi:"Teknologiasta vastaa ThingLink",ru:" ThingLink",pt:"Desenvolvido por ThingLink",es:"Ofrecido por ThingLink",pl:"Zasilane przez ThingLink",it:"Gestito da ThingLink",ja:"ThingLink",fr:"Dvelopp par ThingLink",de:"Betrieben von ThingLink",hi:"ThingLink  ",zh:" ThingLink ",sv:"Utvecklat av ThingLink"},CopyToClipBoard:{en:"Copy to clipboard",fi:"Kopioi leikekirjaan",ru:"  ",pt:"Copiar para a rea de transferncia",es:"Copiar al portapapeles",pl:"Skopiuj do schowka",it:"Copia negli appunti",ja:"",fr:"Copier dans le presse-papiers",de:"In Zwischenablage kopieren",hi:"   ",zh:"",sv:"Kopiera till urklipp"},Copied:{en:"Copied",fi:"Kopioitu",ru:"",pt:"Copiado!",es:"Copiado!",pl:"Skopiowano!",it:"Copiato!",ja:"",fr:"Copi!",de:"Kopiert!",hi:"  ",zh:"",sv:"Kopierad"},"Share.OrJustShareThisAddress":{en:"Or just share this address:",fi:"Tai jaa tm osoite:",ru:"   :",pt:"Ou apenas partilhar este endereo:",es:"O comparte solamente esta direccin:",pl:"Lub podziel si tylko tym adresem:",it:"Oppure condividi solo questo indirizzo:",ja:"",fr:"Ou partager seulement cette adresse:",de:"Oder nur diese Adresse teilen:",hi:"      :",zh:"",sv:"Eller dela den hr adressen:"},OriginallyThinglinked:{en:"Source {0}",de:"Quelle {0}",es:"Fuente {0}",fi:"Lhde {0}",fr:"Source {0}",hi:" {0}",it:"Fonte {0}",ja:" {0}",pl:"rdo {0}",pt:"Fonte {0}",ru:" {0}",sv:"Klla {0}",zh:" {0}"},FourDotsText:{en:"&quot;{0}&quot; by {1}.  See more &#xbb;",fi:"{1}: &quot;{0}&quot;. Katso lis kuvia &#xbb;",ru:"{1}: &quot;{0}&quot;.    &#xbb;",pt:"&quot;{0}&quot; de {1}. Veja mais &#xbb;",es:"&quot;{0}&quot; de {1}. Ver ms &#xbb;",pl:"&quot;{0}&quot; wedug {1}.Zobacz wicej &#xbb;",it:"&quot;{0}&quot; di {1}. Scopri altro &#xbb;",ja:"&quot;{0}&quot;  {1}.  &#xbb;",fr:"&quot;{0}&quot; de {1}. En voir plus &#xbb;",de:"&quot;{0}&quot; von {1}. Mehr sehen &#xbb;",hi:"&quot;{0}&quot;  {1}.   &#xbb;",zh:"&quot;{0}&quot; {1}.  &#xbb;",sv:"&quot;{0}&quot; av {1}. Se mer &#xbb;"},"ContextMenu.Touch":{en:"Touch image",fi:"Kosketa kuvaa",de:"Bild berhren",es:"Dar un Toque a la imagen",fr:"Touchez l'image",hi:"  ( )",it:"Tocca l'immagine",ja:"",pl:"Dotknij obraz",pt:"Toque na imagem",ru:" ",sv:"Peka p bilden",zh:""},"ContextMenu.Share":{en:"Share image...",fi:"Jaa kuva...",ru:"  ...",pt:"Partilhar Imagem...",es:"Compartir imagen...",pl:"Podziel si obrazkiem...",it:"Condividi l'Immagine...",ja:"...",fr:"Partager l'image...",de:"Share Image...",hi:"   ...",zh:"...",sv:"Dela bilden..."},"ContextMenu.Embed":{en:"Embed image...",fi:"Upota kuva...",ru:"  ...",pt:"Inserir Imagem...",es:"Insertar imagen...",pl:"Umie obrazek...",it:"Incorpora l'Immagine...",ja:"...",fr:"Image incorpore...",de:"Bild einbetten...",hi:"   ...",zh:"...",sv:"Infoga bilden..."},"Sidebar.Touch":{en:"Touch image",fi:"Kosketa kuvaa",de:"Bild berhren",es:"Dar un Toque a la imagen",fr:"Touchez l'image",hi:"  ( )",it:"Tocca l'immagine",ja:"",pl:"Dotknij obraz",pt:"Toque na imagem",ru:" ",sv:"Peka p bilden",zh:""},"Sidebar.Untouch":{en:"Untouch image",fi:"Poista kosketus",de:"Berhrung von Bild entfernen",es:"Anular el Toque de la imagen",fr:"D-Touchez l'image",hi:"   ",it:"Togli il Tocco all'immagine",ja:"",pl:"Usu dotknicie",pt:"Desmarque a imagem",ru:"  ",sv:"Peka av bilden",zh:""},"Sidebar.Share":{en:"Share image",fi:"Jaa kuva",ru:"",pt:"Partilhar Imagem",es:"Compartir imagen",pl:"Podziel si obrazkiem",it:"Condividi l'Immagine",ja:"",fr:"Partager l'image",de:"Share Image",hi:"  ",zh:"",sv:"Dela bilden"},"Sidebar.Embed":{en:"Embed image",fi:"Upota kuva",ru:"",pt:"Inserir Imagem",es:"Insertar imagen",pl:"Umie obrazek",it:"Incorpora l'Immagine",ja:"",fr:"Image incorpore",de:"Bild einbetten",hi:"  ",zh:"",sv:"Infoga bilden"},"Sidebar.Edit":{en:"Edit image",fi:"Muokkaa kuvaa",ru:"",pt:"Editar imagem",es:"Editar imagen",pl:"Edytuj obrazek",it:"Modifica l'immagine",ja:"",fr:"Modifier l'image",de:"Bild bearbeiten",hi:"  ",zh:"",sv:"Redigera bilden"},"TouchDialog.TitleError":{en:"Error touching",fi:"Kosketus ei onnistunut"},"TouchDialog.TitleTouch":{en:"Touched image",fi:"Kosketettu",de:"Berhrtes Bild",es:"Imagen con Toques",fr:"Image touche",hi:"  ",it:"immagine toccata",ja:"",pl:"Dotknity obraz",pt:"Imagem tocada",ru:" ",sv:"Pekat p bilden",zh:""},"TouchDialog.TitleUntouch":{en:"Untouched image",fi:"Kosketus poistettu",de:"Unberhrtes Bild",es:"Imagen sin Toques",fr:"Image d-touche",hi:" ",it:"immagine con tolto il tocco",ja:"",pl:"Dotknicie cofnite",pt:"Imagem intocada",ru:" ",sv:"Pekat av bilden",zh:""},"TouchDialog.TouchesOne":{en:"One touch on the image",fi:"Yksi kosketus",de:"1 Berhrung des Bildes",es:"1 Toque en la imagen",fr:"1 Touche sur cette image",hi:"  1    ",it:"1 Tocco sull'immagine",ja:"1",pl:"1 dotyk na obrazie",pt:"1 Toque na imagem",ru:"1  ",sv:"1 pekning p bilden",zh:"1"},"TouchDialog.TouchesNo":{en:"No touches on the image",fi:"Ei kosketuksia",de:"Kein es gefllt mir auf dem Bild.",es:"La imagen no tiene Toques",fr:"Pas de Touche sur cette image",hi:"    ",it:"Nessun Tocco sull'immagine",ja:"",pl:"Brak dotykw na obrazie",pt:"Sem toques na imagem",ru:"  ",sv:"Bilden har inte pekats p",zh:""},"TouchDialog.TouchesOther":{en:"{0} touches on the image",fi:"{0} kosketusta",de:"{0} Berhrungen des Bildes",es:"{0} Toques en la imagen",fr:"{0} Touches sur cette image",hi:"  {0}    ",it:"{0} Tocchi sull'immagine",ja:"{0}",pl:"{0} dotykw na obrazie",pt:"{0} Toques na imagem",ru:"{0}  () ",sv:"{0} pekningar p bilden",zh:"{0}"},"TouchSidebarButton.TouchesOne":{en:"One touch on the image",fi:"Yksi kosketus",de:"1 Berhrung des Bildes",es:"1 Toque en la imagen",fr:"1 Touche sur cette image",hi:"  1    ",it:"1 Tocco sull'immagine",ja:"1",pl:"1 dotyk na obrazie",pt:"1 Toque na imagem",ru:"1  ",sv:"1 pekning p bilden",zh:"1"},"TouchSidebarButton.TouchesNo":{en:"Collect images you like!",fi:"Ker kuvia, joista pidt!",de:"Sammle Bilder, die Dir gefallen!",es:"Colecciona las imgenes que te gusten!",fr:"Collectionez les images que vous aimez",hi:"    !",it:"Raccogli le immagini che ti piacciono!",ja:"",pl:"Zbieraj obrazy, ktre lubisz!",pt:"Recolha imagens de que gosta!",ru:" ,   !",sv:"Samla bilder du gillar!",zh:""},"TouchSidebarButton.TouchesOther":{en:"{0} touches on the image",fi:"{0} kosketusta",de:"{0} Berhrungen des Bildes",es:"{0} Toques en la imagen",fr:"{0} Touches sur cette image",hi:"  {0}    ",it:"{0} Tocchi sull'immagine",ja:"{0}",pl:"{0} dotykw na obrazie",pt:"{0} Toques na imagem",ru:"{0}  () ",sv:"{0} pekningar p bilden",zh:"{0}"},"TouchDialogPreSignup.TouchesOne":{en:"One person has touched the image",fi:"Yksi ihminen on koskettanut tt",de:"Eine Person hat das Bild berhrt",es:"Una persona ha dado un Toque a la imagen",fr:"Une personne a touch cette image ",hi:"      ",it:"Una persona ha toccato l'immagine",ja:"1",pl:"1 osoba dotkna obraz",pt:"Uma pessoa tocou na imagem",ru:"   ",sv:"En person har pekat p bilden",zh:""},"TouchDialogPreSignup.TouchesNo":{en:"This image has not been touched yet",fi:"Kukaan ei viel ole koskettanut tt",de:"Dieses Bild wurde noch nicht berhrt",es:"Esta imagen an no ha recibido Toques",fr:"Cette image n'a pas encore t touche.",hi:"        ",it:"Questa immagine non  stata ancora toccata",ja:"",pl:"Ten obraz nie zosta jeszcze dotknity",pt:"Esta imagem ainda no foi tocada",ru:"    ",sv:"Den hr bilden har inte blivit pekad nnu",zh:""},"TouchDialogPreSignup.TouchesOther":{en:"{0} people have touched the image",fi:"{0} ihmist on koskettanut tt",de:"{0} Leute haben das Bild berhrt",es:"{0} personas han dado un Toque a la imagen",fr:"{0} personnes ont touch cette image ",hi:"{0}      ",it:"{0} persone hanno toccato l'immagine",ja:"{0}",pl:"{0} osb dotkno obraz",pt:"{0} pessoas tocaram na imagem",ru:"{0}  ()  ",sv:"{0} personer har pekat p bilden",zh:"{0}"},"TouchDialogPreSignup.Content":{en:"To touch {0}Sign in!{1} Touching marks the image as a favorite and shares it with those who follow you.",fi:"{0}Kirjaudu sisn{1} koskettaaksesi!  Kun kosketat kuvaa, se tallentuu itsellesi ja nkyy niille, jotka seuraavat sinua."},"TouchDialogPreSignup.ContentOriginal":{en:"To touch {0}Sign in!{1} Touching marks the image as a favorite and shares it with those who follow you.",fi:"{0}Kirjaudu sisn{1} koskettaaksesi! Kun kosketat kuvaa, se tallentuu itsellesi ja nkyy niille, jotka seuraavat sinua."},"TouchDialogPreSignup.TitleDoYouLikeThisImage":{en:"Do you like this image? <p style='font-weight: bold !important; display: inline;'>TOUCH it!</p>",fi:"Pidtk tst kuvasta? <p style='font-weight: bold !important; display: inline;'>KOSKETA sit!</p>",de:"Mgen Sie dieses Bild? <p style='font-weight: bold !important; display: inline;'>Bild berhren</p>",es:"Te gusta esta imagen? <p style='font-weight: bold !important; display: inline;'>Dar un Toque a la imagen</p>",fr:"Aimez vous cette image? <p style='font-weight: bold !important; display: inline;'>Touchez l'image</p>",hi:"     ? <p style='font-weight: bold !important; display: inline;'>  ( )</p>",it:"Ti piace questa immagine? <p style='font-weight: bold !important; display: inline;'>Tocca l'immagine</p>",ja:" <p style='font-weight: bold !important; display: inline;'></p>",pl:"Lubisz ten obraz? <p style='font-weight: bold !important; display: inline;'>Dotknij obraz</p>",pt:"Gosta desta imagem? <p style='font-weight: bold !important; display: inline;'>Toque na imagem</p>",ru:"   ? <p style='font-weight: bold !important; display: inline;'> </p>",sv:"Gillar du denna bild? <p style='font-weight: bold !important; display: inline;'>Peka p bilden</p>",zh:" <p style='font-weight: bold !important; display: inline;'></p>"},"TouchDialogPreSignup.ContentDoYouLikeThisImage":{en:"{0}Sign in{1}to ThingLink to create your own interactive images!",fi:"{0}Kirjaudu sisn{1}Thinglink-palveluun ja tee omia interaktiivisia kuvia!",de:"Bei ThingLink {0}anmelden{1}, um eigene interaktive Bilder zu erstellen!",es:"- Regstrate en ThingLink para crear tus propias imgenes interactivas!",fr:"{0}Enregistrez vous{1}  ThingLink pour crer vos propres images intractives",hi:"        ThingLink   {0}   {1}  !",it:"{0}Accedi{1} a ThingLink per creare le tue immagini interattive!",ja:"ThingLink {0}{1}",pl:"{0}Zaloguj si{1} do ThingLink, aby tworzy wasne interaktywne obrazy!",pt:"{0}Inscreva{1}se- no ThingLink para criar as suas prprias imagens interativas!",ru:"{0}   {1} ThingLink,     !",sv:"{0}Logga in{1} till ThingLink fr att skapa dina egna interaktiva bilder!",zh:"{0}  {1} ThingLink"}};var e="en";function b(g){var j=1,f;var h=a[g][c.language||e];if(!h||(d.browser.msie&&d.browser.version<=7&&document.charset&&document.charset!=="utf-8")){h=a[g]["en"];if(!h){return""+g+""}}for(f=j;f<arguments.length;f++){h=h.replace("{"+(f-j)+"}",arguments[f])}return h}return b});tlRequire.define("util",[],function(){function j(l){var n=l.indexOf("://");if(n===-1){if(l.substring(0,2)==="//"){n=2}else{n=0}}else{n=n+3}var m=l.indexOf("/",n);if(m===-1){m=l.indexOf("?",n);if(m===-1){m=l.length}}l=l.substring(n,m);m=l.indexOf(":");if(m!=-1){l=l.substring(0,m)}return l}function e(){return("https:"==document.location.protocol)?"https:":"http:"}function k(m){var l;try{l=decodeURIComponent(m)}catch(n){l=null}return l?encodeURI(l):encodeURI(m)}function c(l){return l.replace(/;\$?\d+$/,"")}function f(m){m=String(m);var l=m.lastIndexOf(";");if(l>0&&l<m.length-1){var n=m.slice(l+1);return n}if(/^\d+$/.test(m)){return m}return""}function b(p,o){var n="";var l=o?"!important":"";var m;for(m in p){if(p.hasOwnProperty(m)){n+=(m+":"+p[m]+l+";")}}return n}function a(){if(/MSIE (\d+\.\d+);/.test(navigator.userAgent)){var l=parseFloat(RegExp.$1);if(l<=6){return true}}return false}function d(l){return(l===undefined)}function i(){var l=0;var m=0;if(!window.innerWidth){if(document.documentElement.clientWidth!==0){l=document.documentElement.clientWidth;m=document.documentElement.clientHeight}else{l=document.body.clientWidth;m=document.body.clientHeight}}else{l=window.innerWidth;m=window.innerHeight}return{width:l,height:m}}function g(o){var r=o.getBoundingClientRect();var s=document.body;var m=document.documentElement;var l=window.pageYOffset||m.scrollTop||s.scrollTop;var p=window.pageXOffset||m.scrollLeft||s.scrollLeft;var q=m.clientTop||s.clientTop||0;var t=m.clientLeft||s.clientLeft||0;var u=r.top+l-q;var n=r.left+p-t;return{top:Math.round(u),left:Math.round(n)}}var h=(function(){return document.documentElement.hasOwnProperty&&document.documentElement.hasOwnProperty("ontouchstart")}());return{cleanURIEncoding:k,extractUrl:c,extractSceneId:f,mapToCssText:b,browserIsIE6:a,no:d,getWindowSize:i,getOffsetRect:g,getDomain:j,getProtocol:e,isTouchDevice:h}});